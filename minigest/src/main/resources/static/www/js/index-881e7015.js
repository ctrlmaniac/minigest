import{r as O,_ as F,v as Y,c as J,a as n,Y as T,Z as D,$ as Q,R as z,j as S,F as q,a0 as X}from"./index-d9075882.js";import{e as ee,a as U,E as Z,u as ie,b as K,T as x}from"./index-0b6f6c0e.js";import{a as ne}from"./exists-7d8a17c3.js";import{l as re}from"./lodash-18ebe8c4.js";import{g as te,a as oe,s as ae,e as se,c as ce,b as le,B as A}from"./Box-2c01ad1c.js";import{P as R,A as _}from"./Alert-34d97dd7.js";import{T as E}from"./Typography-0244ac9d.js";import"./ButtonBase-a1aa1359.js";const ue=O.createContext(),L=ue;function de(e){return te("MuiGrid",e)}const pe=[0,1,2,3,4,5,6,7,8,9,10],me=["column-reverse","column","row-reverse","row"],ge=["nowrap","wrap-reverse","wrap"],V=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],P=oe("MuiGrid",["root","container","item","zeroMinWidth",...pe.map(e=>`spacing-xs-${e}`),...me.map(e=>`direction-xs-${e}`),...ge.map(e=>`wrap-xs-${e}`),...V.map(e=>`grid-xs-${e}`),...V.map(e=>`grid-sm-${e}`),...V.map(e=>`grid-md-${e}`),...V.map(e=>`grid-lg-${e}`),...V.map(e=>`grid-xl-${e}`)]),fe=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function I(e){const t=parseFloat(e);return`${t}${String(e).replace(String(t),"")||"px"}`}function he({theme:e,ownerState:t}){let r;return e.breakpoints.keys.reduce((i,a)=>{let o={};if(t[a]&&(r=t[a]),!r)return i;if(r===!0)o={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(r==="auto")o={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const p=T({values:t.columns,breakpoints:e.breakpoints.values}),d=typeof p=="object"?p[a]:p;if(d==null)return i;const c=`${Math.round(r/d*1e8)/1e6}%`;let g={};if(t.container&&t.item&&t.columnSpacing!==0){const s=e.spacing(t.columnSpacing);if(s!=="0px"){const v=`calc(${c} + ${I(s)})`;g={flexBasis:v,maxWidth:v}}}o=F({flexBasis:c,flexGrow:0,maxWidth:c},g)}return e.breakpoints.values[a]===0?Object.assign(i,o):i[e.breakpoints.up(a)]=o,i},{})}function xe({theme:e,ownerState:t}){const r=T({values:t.direction,breakpoints:e.breakpoints.values});return D({theme:e},r,i=>{const a={flexDirection:i};return i.indexOf("column")===0&&(a[`& > .${P.item}`]={maxWidth:"none"}),a})}function H({breakpoints:e,values:t}){let r="";Object.keys(t).forEach(a=>{r===""&&t[a]!==0&&(r=a)});const i=Object.keys(e).sort((a,o)=>e[a]-e[o]);return i.slice(0,i.indexOf(r))}function ve({theme:e,ownerState:t}){const{container:r,rowSpacing:i}=t;let a={};if(r&&i!==0){const o=T({values:i,breakpoints:e.breakpoints.values});let p;typeof o=="object"&&(p=H({breakpoints:e.breakpoints.values,values:o})),a=D({theme:e},o,(d,c)=>{var g;const s=e.spacing(d);return s!=="0px"?{marginTop:`-${I(s)}`,[`& > .${P.item}`]:{paddingTop:I(s)}}:(g=p)!=null&&g.includes(c)?{}:{marginTop:0,[`& > .${P.item}`]:{paddingTop:0}}})}return a}function we({theme:e,ownerState:t}){const{container:r,columnSpacing:i}=t;let a={};if(r&&i!==0){const o=T({values:i,breakpoints:e.breakpoints.values});let p;typeof o=="object"&&(p=H({breakpoints:e.breakpoints.values,values:o})),a=D({theme:e},o,(d,c)=>{var g;const s=e.spacing(d);return s!=="0px"?{width:`calc(100% + ${I(s)})`,marginLeft:`-${I(s)}`,[`& > .${P.item}`]:{paddingLeft:I(s)}}:(g=p)!=null&&g.includes(c)?{}:{width:"100%",marginLeft:0,[`& > .${P.item}`]:{paddingLeft:0}}})}return a}function ze(e,t,r={}){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[r[`spacing-xs-${String(e)}`]];const i=[];return t.forEach(a=>{const o=e[a];Number(o)>0&&i.push(r[`spacing-${a}-${String(o)}`])}),i}const Ce=ae("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e,{container:i,direction:a,item:o,spacing:p,wrap:d,zeroMinWidth:c,breakpoints:g}=r;let s=[];i&&(s=ze(p,g,t));const v=[];return g.forEach(w=>{const f=r[w];f&&v.push(t[`grid-${w}-${String(f)}`])}),[t.root,i&&t.container,o&&t.item,c&&t.zeroMinWidth,...s,a!=="row"&&t[`direction-xs-${String(a)}`],d!=="wrap"&&t[`wrap-xs-${String(d)}`],...v]}})(({ownerState:e})=>F({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},e.wrap!=="wrap"&&{flexWrap:e.wrap}),xe,ve,we,he);function be(e,t){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[`spacing-xs-${String(e)}`];const r=[];return t.forEach(i=>{const a=e[i];if(Number(a)>0){const o=`spacing-${i}-${String(a)}`;r.push(o)}}),r}const Se=e=>{const{classes:t,container:r,direction:i,item:a,spacing:o,wrap:p,zeroMinWidth:d,breakpoints:c}=e;let g=[];r&&(g=be(o,c));const s=[];c.forEach(w=>{const f=e[w];f&&s.push(`grid-${w}-${String(f)}`)});const v={root:["root",r&&"container",a&&"item",d&&"zeroMinWidth",...g,i!=="row"&&`direction-xs-${String(i)}`,p!=="wrap"&&`wrap-xs-${String(p)}`,...s]};return le(v,de,t)},Ae=O.forwardRef(function(t,r){const i=Y({props:t,name:"MuiGrid"}),{breakpoints:a}=ee(),o=se(i),{className:p,columns:d,columnSpacing:c,component:g="div",container:s=!1,direction:v="row",item:w=!1,rowSpacing:f,spacing:W=0,wrap:C="wrap",zeroMinWidth:G=!1}=o,b=J(o,fe),y=f||W,j=c||W,M=O.useContext(L),N=s?d||12:M,k={},B=F({},b);a.keys.forEach(h=>{b[h]!=null&&(k[h]=b[h],delete B[h])});const l=F({},o,{columns:N,container:s,direction:v,item:w,rowSpacing:y,columnSpacing:j,wrap:C,zeroMinWidth:G,spacing:W},k,{breakpoints:a.keys}),u=Se(l);return n(L.Provider,{value:N,children:n(Ce,F({ownerState:l,className:ce(u.root,p),as:g,ref:r},B))})}),m=Ae;function $e(e="IT",t=""){return async r=>{U.get(`${Z.AZIENDE}/exists?nazione=${e}&codice=${t}`).then(i=>{r(Q(i.data))}).catch(i=>{let a=!1;i.response?a=i.response.data:a=!1,console.log(a)})}}function ye(e){return async t=>{U.post(`${Z.AUTH}/register`,e).then(r=>{console.log(r),window.location.href="/app"}).catch(r=>{console.log(r);let i="Errore";r.response?i=r.response.data:i="Errore",console.log(i)})}}const Be=()=>{const e=ie(),{exists:t}=K(l=>l.account),{exists:r}=K(l=>l.aziende),[i,a]=z.useState({nome:"",cognome:"",email:"",password:"",passwordRepeat:""}),[o,p]=z.useState({nome:!0,cognome:!0,email:!0,password:!0,passwordRepeat:!0});z.useEffect(()=>{e(ne(i.email))},[i]);const d=l=>{const{value:u,name:h}=l.target;a({...i,[h]:u}),p({...o,[h]:u.toString().length<1})};z.useEffect(()=>{p({...o,password:i.password!==i.passwordRepeat||i.password.toString().length<1,passwordRepeat:i.password!==i.passwordRepeat||i.passwordRepeat.toString().length<1})},[i]);const[c,g]=z.useState({denominazione:"",idFiscaleIVAPaese:"IT",idFiscaleIVACodice:"",codiceFiscale:""}),[s,v]=z.useState({denominazione:!0,idFiscaleIVAPaese:!1,idFiscaleIVACodice:!0,codiceFiscale:!0});z.useEffect(()=>{e($e(c.idFiscaleIVAPaese,c.idFiscaleIVACodice))},[c]);const w=l=>{const{name:u,value:h}=l.target;g({...c,[u]:h}),r?(v({...s,denominazione:!1,codiceFiscale:!1}),(u==="idFiscaleIVACodice"||u=="idFiscaleIVAPaese")&&v({...s,[u]:h.toString().length<1})):v({...s,[u]:h.toString().length<1})},[f,W]=z.useState({indirizzo:"",numeroCivico:"",cap:"",comune:"",provincia:"",nazione:"IT"}),[C,G]=z.useState({indirizzo:!0,numeroCivico:!1,cap:!0,comune:!0,provincia:!1,nazione:!1}),b=l=>{const{name:u,value:h,required:$}=l.target;W({...f,[u]:h}),$&&G({...C,[u]:h.toString().length<1})},[y,j]=z.useState({nome:""}),M=l=>{const{value:u}=l.target;j({...y,nome:u})},[N,k]=z.useState(!0);z.useEffect(()=>{const l=!Object.values(o).every($=>$===!1),u=r?!1:!Object.values(s).every($=>$===!1),h=r?!1:!Object.values(C).every($=>$===!1);console.log(l,u,h),k(l||u||h)},[r,o,s,C]);const B=()=>{let l={nome:i.nome,cognome:i.cognome,email:i.email,password:i.password};if(r)l={...l,addMeTo:{idFiscaleIVAPaese:c.idFiscaleIVAPaese,idFiscaleIVACodice:c.idFiscaleIVACodice}};else{let u={...c,sede:{...f}};re.isEmpty(y.nome)||(u={...u,negozi:[{...y}]}),l={...l,azienda:{...c,sede:{...f}}}}e(ye(l))};return S(q,{children:[n(A,{mb:3,children:n(R,{children:S(A,{p:2,children:[n(E,{variant:"h6",gutterBottom:!0,children:"Dati Personali"}),S(m,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"flex-start",spacing:2,children:[n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Nome",name:"nome",value:i.nome,error:o.nome,onChange:d,required:!0})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Cognome",name:"cognome",value:i.cognome,error:o.cognome,onChange:d,required:!0})}),S(m,{item:!0,xs:12,children:[n(x,{fullWidth:!0,label:"Email",name:"email",value:i.email,error:o.email,onChange:d,type:"email",required:!0}),i.email.toString().length>0&&n(_,{severity:t?"error":"success",variant:"outlined",children:t?"Account già registrato!":"Account disponibile"})]}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Password",name:"password",value:i.password,error:o.password,onChange:d,type:"password",helperText:o.password?"le password devono coincidere":"password conforme",required:!0})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Ripeti Password",name:"passwordRepeat",value:i.passwordRepeat,error:o.passwordRepeat,onChange:d,type:"password",helperText:o.password?"le password devono coincidere":"password conforme",required:!0})})]})]})})}),n(A,{mb:3,children:n(R,{children:S(A,{p:2,children:[n(E,{variant:"h6",gutterBottom:!0,children:"Aggiungi la tua azienda"}),S(m,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[n(m,{item:!0,xs:12,children:n(x,{label:"Denominazione o Nome e Cognome",name:"denominazione",value:c.denominazione,error:s.denominazione,fullWidth:!0,onChange:w})}),n(m,{item:!0,xs:2,children:n(x,{label:"Nazione",name:"idFiscaleIVAPaese",value:c.idFiscaleIVAPaese,error:s.idFiscaleIVAPaese,fullWidth:!0,onChange:w})}),n(m,{item:!0,xs:10,children:n(x,{label:"Partita IVA",name:"idFiscaleIVACodice",value:c.idFiscaleIVACodice,error:s.idFiscaleIVACodice,fullWidth:!0,onChange:w})}),n(m,{item:!0,xs:12,children:c.idFiscaleIVAPaese.toString().length>0&&c.idFiscaleIVACodice.toString().length>0&&n(_,{severity:r?"error":"success",variant:"outlined",children:r?"Azienda già esistente! Dovrai essere aggiunto manualmente da un nostro moderatore!":"Azienda disponibile"})}),n(m,{item:!0,xs:12,children:n(x,{label:"Codice Fiscale",name:"codiceFiscale",value:c.codiceFiscale,error:s.codiceFiscale,fullWidth:!0,onChange:w})})]})]})})}),!r&&S(q,{children:[n(A,{mb:3,children:n(R,{children:S(A,{p:2,children:[n(E,{gutterBottom:!0,variant:"h6",children:"Aggiungi la sede della tua azienda"}),S(m,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[n(m,{item:!0,xs:10,children:n(x,{fullWidth:!0,label:"Indirizzo",name:"indirizzo",value:f.indirizzo,error:C.indirizzo,required:!0,onChange:b})}),n(m,{item:!0,xs:2,children:n(x,{fullWidth:!0,label:"N. Civico",name:"numeroCivico",value:f.numeroCivico,error:C.numeroCivico,onChange:b})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"CAP",name:"cap",value:f.cap,error:C.cap,required:!0,onChange:b})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Comune",name:"comune",value:f.comune,error:C.comune,required:!0,onChange:b})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Provincia",name:"provincia",value:f.provincia,error:C.provincia,onChange:b,helperText:"Esempio: BS"})}),n(m,{item:!0,xs:12,sm:6,children:n(x,{fullWidth:!0,label:"Nazione",name:"nazione",value:f.nazione,error:C.nazione,onChange:b,required:!0,helperText:"Esempio: IT"})})]})]})})}),n(A,{mb:16,children:n(R,{children:S(A,{p:2,children:[n(E,{gutterBottom:!0,variant:"h6",children:"Aggiungi il nome del tuo negozio"}),n(E,{variant:"subtitle1",gutterBottom:!0,children:"Se non hai un negozio non aggiungerlo"}),n(x,{fullWidth:!0,label:"Nome Negozio",name:"nome",value:y.nome,onChange:M})]})})})]}),n(X,{onClick:B,disabled:N||t})]})};export{Be as default};
