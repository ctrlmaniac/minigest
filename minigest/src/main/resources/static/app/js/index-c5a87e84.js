import{a1 as w,a2 as P,a3 as k,at as B,f as $,R as h,aQ as j,l as f,b as e,V as R,j as o,F as x,a4 as q,a5 as N,ak as V}from"./index-b0edc525.js";import{a as W,E as Y,I as G}from"./index-c1f533ec.js";import{e as M,d as y,B as l,T as Q,P as T}from"./hooks-f9dc248c.js";import{A as D}from"./Alert-bf912103.js";import{A as H}from"./AlertTitle-cc53b190.js";import{I as L}from"./IconBuildingWarehouse-8cf92b18.js";import{G as u}from"./Grid-6e4f877e.js";import{T as F}from"./TextField-11ad0b6f.js";import{F as U}from"./FormControlLabel-e9a46022.js";import{C as J}from"./Checkbox-3382e444.js";import{T as K,a as E,b as i,c as O}from"./TableRow-1c21061b.js";import{T as X}from"./TableHead-339200f6.js";import{I as Z,a as _,b as ee}from"./IconInfoCircle-1ea9dc07.js";import{I as z}from"./IconFile-f40274b7.js";import"./createReactComponent-9058c6b6.js";import"./Grow-f5e1a89c.js";import"./useFormControl-1aadaf80.js";import"./Portal-3b6c3c12.js";import"./useControlled-467ac937.js";function ne(r,p,c="sdi=false"){return async s=>{s(w()),W.get(`${Y.FATTURE}/${r}/${p}?${c}`).then(t=>{s(P(t.data))}).catch(t=>{let a="Errore";t.response?a=t.response.data:a="Errore",s(k(a))})}}const Se=()=>{const{mode:r}=B(),p=M(),c=$(),{list:s}=y(n=>n.fatture),{selected:t}=y(n=>n.aziende),[a,v]=h.useState({anno:new Date().getFullYear(),mese:new Date().getMonth()+1,sdi:!1}),[d,b]=h.useState({anno:!1,mese:!1}),[C,A]=j({sdi:a.sdi.toString(),anno:a.anno.toString(),mese:a.mese.toString()}),I=n=>{const{name:g,value:S}=n.target;v({...a,[g]:S});const m=parseInt(S);g==="anno"&&b({...d,anno:m<1970||m>new Date().getFullYear()}),g==="mese"&&b({...d,mese:m<1||m>12})};return h.useEffect(()=>{A({anno:a.anno.toString(),mese:a.mese.toString(),sdi:a.sdi.toString()})},[a]),h.useEffect(()=>{f.isEmpty(t)||(r==="vendita"||r==="acquisto")&&(console.log(r),p(ne(r,t.id,C.toString())))},[r,t,C]),r!=="acquisto"&&r!=="vendita"?e(R,{message:"Pagina non trovata!"}):o(x,{children:[e(l,{mb:3,children:o(Q,{variant:"h3",children:["Fatture ",r]})}),f.isEmpty(t)?e(l,{mb:3,children:o(D,{severity:"error",variant:"outlined",children:[e(H,{children:"Devi selezionare un'azienda!"}),"Per visualizzare le fatture devi prima selezionare un'azienda! Clicca sull'icona in alto a sinistra ",e(L,{})," per selezionarne una!"]})}):o(x,{children:[e(l,{mb:3,children:e(T,{children:e(l,{p:2,children:o(u,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(u,{item:!0,xs:12,sm:6,children:e(F,{label:"Anno",name:"anno",value:a.anno,error:d.anno,onChange:I,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(u,{item:!0,xs:12,sm:6,children:e(F,{label:"Mese",name:"mese",value:a.mese,error:d.mese,onChange:I,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})}),e(u,{item:!0,xs:12,children:e(U,{value:"ordina per data sdi",control:e(J,{onChange:n=>v({...a,sdi:n.target.checked})}),label:"ordina per data sdi"})})]})})})}),f.isEmpty(s)?e(D,{severity:"info",variant:"outlined",children:"Non ci sono fatture, aggiungine una!"}):e(l,{mb:3,children:e(T,{children:e(l,{p:3,children:o(K,{children:[e(X,{children:o(E,{children:[e(i,{children:"Documento"}),e(i,{children:"Data"}),e(i,{children:"Data SDI"}),e(i,{children:r==="vendita"?"Committente":"Cedente"}),e(i,{children:"Numero"}),e(i,{sx:{width:50},align:"center",children:e(Z,{})}),e(i,{sx:{width:50},align:"center",children:e(z,{})})]})}),e(O,{children:s==null?void 0:s.map(n=>o(E,{children:[e(i,{children:n.tipoDocumento.codice}),e(i,{children:n.data}),e(i,{children:n.dataSDI}),e(i,{children:r==="vendita"?n.committente.denominazione:n.cedente.denominazione}),e(i,{children:n.numero}),e(i,{children:n.evasa?e(_,{color:q[500]}):e(ee,{color:N[500]})}),e(i,{children:e(G,{color:"info",onClick:()=>c(`/docfisc/fatture/dettagli/${n.id}`),children:e(z,{})})})]},n.id))})]})})})}),e(V,{onClick:()=>c("/docfisc/fatture/aggiungi")})]})]})};export{Se as default};
