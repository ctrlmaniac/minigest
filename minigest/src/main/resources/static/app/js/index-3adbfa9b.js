import{bn as C,bo as S,bp as D,R as u,l as p,d as i,F as g,j as e}from"./index-94156edf.js";import{a as F,E as w}from"./index-ceaeaac0.js";import{f as q,e as y,B as c,T as P,P as z}from"./hooks-bf5842b6.js";import{A as f}from"./Alert-9526df75.js";import{A as j}from"./AlertTitle-d854389a.js";import{I as $}from"./IconBuildingStore-43459ca1.js";import{G as b}from"./Grid-4252230b.js";import{T as E}from"./TextField-2417de86.js";import{T as B,a as v,b as a,c as V}from"./TableRow-35a584e7.js";import{T as G}from"./TableHead-90bb1086.js";import"./createReactComponent-2aca6431.js";import"./Grow-91bcfd76.js";import"./useFormControl-dd0c56d7.js";function L(h){return async t=>{t(C()),F.get(`${w.REGISTRO_CORRISPETTIVI}?${h}`).then(o=>{t(S(o.data))}).catch(o=>{let n="Errore";o.response?n=o.response.data:n="Errore",t(D(n))})}}const Z=()=>{const h=q(),{selected:t}=y(r=>r.negozi),{registro:o}=y(r=>r.registroCorrispettivi),[n,x]=u.useState({negozio:t?t.id:"",anno:new Date().getFullYear(),mese:new Date().getMonth()+1}),[d,T]=u.useState({anno:!1,mese:!1});u.useEffect(()=>{p.isEmpty(t)||x({...n,negozio:t.id})},[t]);const R=r=>{const{name:s,value:m}=r.target;x({...n,[s]:m});const l=parseInt(m);s==="anno"&&T({...d,anno:l<1970||l>new Date().getFullYear()}),s==="mese"&&T({...d,mese:l<1||l>12})};return u.useEffect(()=>{const r=`negozio=${n.negozio}&anno=${n.anno}&mese=${n.mese}`;h(L(r))},[n]),i(g,{children:[e(c,{mb:3,children:e(P,{variant:"h3",children:"Registro dei Corrispettivi"})}),p.isEmpty(t)?i(f,{variant:"outlined",severity:"error",children:[e(j,{children:"Devi selezionare un negozio!"}),"Per visualizzare le chiusure fiscali devi prima selezionare un negozio. Clicca sull'icona ",e($,{})," in alto a sinistra e selezionane uno!"]}):i(g,{children:[e(c,{mb:3,children:i(f,{severity:"info",variant:"outlined",children:["Stai visualizzando il registro dei corrispettivi del negozio"," ",t.nome]})}),e(c,{mb:3,children:e(z,{children:e(c,{p:2,children:i(b,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(b,{item:!0,xs:12,sm:6,children:e(E,{label:"Anno",name:"anno",value:n.anno,error:d.anno,onChange:R,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(b,{item:!0,xs:12,sm:6,children:e(E,{label:"Mese",name:"mese",value:n.mese,error:d.mese,onChange:R,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})})]})})})}),p.isEmpty(o)?e(f,{variant:"outlined",severity:"info",children:"Non sono presenti chiusure fiscali quindi non c'è nemmeno un registro dei corrispettivi!"}):e(g,{children:e(c,{children:e(z,{children:e(c,{p:2,sx:{overflowX:"auto"},children:i(B,{children:[i(G,{children:[i(v,{children:[e(a,{colSpan:3,sx:{borderLeft:1,borderRight:1},children:"Riepilogo"}),o.aliquoteIVA.map((r,s)=>i(a,{sx:{borderRight:1},children:[r," %"]},s))]}),i(v,{children:[e(a,{sx:{borderLeft:1},children:"Data"}),e(a,{children:"Totale"}),e(a,{sx:{borderRight:1},children:"N.D.F."}),o.aliquoteIVA.map((r,s)=>e(a,{sx:{borderRight:1},children:"Totale"},s))]})]}),e(V,{children:o.corrispettivi.map((r,s)=>{const m=Object.keys(r.reparti);return i(v,{children:[e(a,{sx:{borderLeft:1},children:r.data}),i(a,{children:["€ ",r.totale]}),e(a,{sx:{borderRight:1},children:r.numeroDocFisc||0}),m.map((l,I)=>{const A=r.reparti[l];return i(a,{sx:{borderRight:1},children:["€ ",A.totale]},I)})]},s)})})]})})})})})]})]})};export{Z as default};
