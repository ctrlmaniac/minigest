import{a1 as w,a2 as P,a3 as k,at as B,i as R,R as u,aQ as j,l as f,j as e,V as N,d as o,F as S,a4 as V,a5 as W,ak as Y}from"./index-6a75a5de.js";import{E as x,a as q,I as G}from"./index-db9e3c6a.js";import{f as M,e as F,B as l,T as Q,P as y}from"./hooks-8b6b3ce5.js";import{A as D}from"./Alert-863a23eb.js";import{A as U}from"./AlertTitle-c2d2966c.js";import{I as H}from"./IconBuildingWarehouse-bd7b1f29.js";import{G as p}from"./Grid-f0b91695.js";import{T as E}from"./TextField-09f22a56.js";import{F as L}from"./FormControlLabel-94be6f50.js";import{C as J}from"./Checkbox-c690e125.js";import{T as K,a as A,b as i,c as O}from"./TableRow-c65b3546.js";import{T as X}from"./TableHead-40379dbf.js";import{I as Z,a as _,b as ee}from"./IconInfoCircle-46578e76.js";import{I as z}from"./IconFile-95cab889.js";import"./createReactComponent-2662947b.js";import"./Grow-234efcfb.js";import"./useFormControl-ec2a69e6.js";function ne(r,d,c="sdi=false"){return async s=>{s(w()),console.log(`${x.FATTURE}/${r}/${d}?${c}`),q.get(`${x.FATTURE}/${r}/${d}?${c}`).then(t=>{s(P(t.data))}).catch(t=>{let a="Errore";t.response?a=t.response.data:a="Errore",s(k(a))})}}const Ce=()=>{const{mode:r}=B(),d=M(),c=R(),{list:s}=F(n=>n.fatture),{selected:t}=F(n=>n.aziende),[a,v]=u.useState({anno:new Date().getFullYear(),mese:new Date().getMonth()+1,sdi:!1}),[m,b]=u.useState({anno:!1,mese:!1}),[C,$]=j({sdi:a.sdi.toString(),anno:a.anno.toString(),mese:a.mese.toString()}),I=n=>{const{name:g,value:T}=n.target;v({...a,[g]:T});const h=parseInt(T);g==="anno"&&b({...m,anno:h<1970||h>new Date().getFullYear()}),g==="mese"&&b({...m,mese:h<1||h>12})};return u.useEffect(()=>{$({anno:a.anno.toString(),mese:a.mese.toString(),sdi:a.sdi.toString()})},[a]),u.useEffect(()=>{f.isEmpty(t)||(r==="vendita"||r==="acquisto")&&(console.log(r),d(ne(r,t.id,C.toString())))},[r,t,C]),r!=="acquisto"&&r!=="vendita"?e(N,{message:"Pagina non trovata!"}):o(S,{children:[e(l,{mb:3,children:o(Q,{variant:"h3",children:["Fatture ",r]})}),f.isEmpty(t)?e(l,{mb:3,children:o(D,{severity:"error",variant:"outlined",children:[e(U,{children:"Devi selezionare un'azienda!"}),"Per visualizzare le fatture devi prima selezionare un'azienda! Clicca sull'icona in alto a sinistra ",e(H,{})," per selezionarne una!"]})}):o(S,{children:[e(l,{mb:3,children:e(y,{children:e(l,{p:2,children:o(p,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(p,{item:!0,xs:12,sm:6,children:e(E,{label:"Anno",name:"anno",value:a.anno,error:m.anno,onChange:I,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(p,{item:!0,xs:12,sm:6,children:e(E,{label:"Mese",name:"mese",value:a.mese,error:m.mese,onChange:I,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})}),e(p,{item:!0,xs:12,children:e(L,{value:"ordina per data sdi",control:e(J,{onChange:n=>v({...a,sdi:n.target.checked})}),label:"ordina per data sdi"})})]})})})}),f.isEmpty(s)?e(D,{severity:"info",variant:"outlined",children:"Non ci sono fatture, aggiungine una!"}):e(l,{mb:3,children:e(y,{children:e(l,{p:3,children:o(K,{children:[e(X,{children:o(A,{children:[e(i,{children:"Documento"}),e(i,{children:"Data"}),e(i,{children:"Data SDI"}),e(i,{children:r==="vendita"?"Committente":"Cedente"}),e(i,{children:"Numero"}),e(i,{sx:{width:50},align:"center",children:e(Z,{})}),e(i,{sx:{width:50},align:"center",children:e(z,{})})]})}),e(O,{children:s==null?void 0:s.map(n=>o(A,{children:[e(i,{children:n.tipoDocumento.codice}),e(i,{children:n.data}),e(i,{children:n.dataSDI}),e(i,{children:r==="vendita"?n.committente.denominazione:n.cedente.denominazione}),e(i,{children:n.numero}),e(i,{children:n.evasa?e(_,{color:V[500]}):e(ee,{color:W[500]})}),e(i,{children:e(G,{color:"info",onClick:()=>c(`/docfisc/fatture/dettagli/${n.id}`),children:e(z,{})})})]},n.id))})]})})})}),e(Y,{onClick:()=>c("/docfisc/fatture/aggiungi")})]})]})};export{Ce as default};
