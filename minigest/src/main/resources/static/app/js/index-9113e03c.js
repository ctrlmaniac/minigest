import{aw as J,ax as K,ay as Q,az as U,aA as X,aB as Y,aC as _,R as m,d as i,F as A,j as e,l as r,ac as ee,aD as I,aE as ae}from"./index-c637eda0.js";import{a as $,E as j,I as x}from"./index-450aab6b.js";import{f as oe,e as B,B as p,T as te,P as ne}from"./hooks-edca5f41.js";import{I as se,p as ie}from"./post-1cfe8edd.js";import{A as c}from"./Alert-ab1cdef6.js";import{A as D}from"./AlertTitle-cb5e6684.js";import{T as re,a as le,b as ce,c as h}from"./TableRow-70220851.js";import{I as de}from"./IconPencil-e075d05c.js";import{I as me}from"./IconTrash-3f20ee64.js";import{a as k,b as R}from"./DialogContent-e273fbb2.js";import{T as w}from"./TextField-3b54eb4a.js";import{D as F}from"./DialogActions-cd5bac03.js";import{B as P}from"./Button-66e36a49.js";import{L as W}from"./LinearProgress-1c3cd5ee.js";import{S as M}from"./Snackbar-b1c4388f.js";import"./createReactComponent-23dfa4e0.js";function ue(t){return async o=>{o(J()),$.delete(`${j.NEGOZI}/${t}`).then(n=>{o(K(n.data)),o(Q(t))}).catch(n=>{let s="Errore";n.response?s=n.response.data:s="Errore",o(U(s))})}}function pe(t){return async o=>{o(X()),$.put(`${j.NEGOZI}/${t.id}`,t).then(n=>{o(Y(n.data))}).catch(n=>{let s="Errore";n.response?s=n.response.data:s="Errore",o(_(s))})}}const De=()=>{var N;const t=oe(),{selected:o}=B(a=>a.aziende),{putting:n,putError:s,putResponse:g,removeError:G,removeResponse:f,posting:L}=B(a=>a.negozi),[v,z]=m.useState(!1),[E,y]=m.useState(!1),[l,u]=m.useState({id:void 0,nome:""}),[S,C]=m.useState(!1),T=a=>{u({...l,nome:a.target.value}),C(a.target.value.toString().length<1)},O=a=>{t(ue(a)),setTimeout(()=>{t(I())},2e3)},Z=a=>{u({...a}),z(!0)},V=()=>{u({id:void 0,nome:""}),C(!1)},d=()=>{z(!1),y(!1),V()},b=()=>{t(pe(l)),d(),setTimeout(()=>{t(I()),t(ae(l))},1e3)},q=a=>{t(ie(a)),d()},H=()=>{if(E){const a={azienda:o,nome:l.nome};q(a)}else v&&b()};return i(A,{children:[e(p,{mb:3,children:e(te,{variant:"h3",gutterBottom:!0,children:"Negozi"})}),r.isEmpty(o)&&i(c,{variant:"outlined",severity:"error",children:[e(D,{children:"Non hai selezionato nessuna azienda!"}),"Prima di visualizzare la lista dei negozi, seleziona l'azienda a cui appartengono. Clicca su ",e(se,{})," in alto a destra per selezionare l'azienda!"]}),!r.isEmpty(o)&&r.isEmpty(o.negozi)&&i(c,{variant:"outlined",severity:"info",children:[e(D,{children:"Non hai nessun negozio"}),"Aggiungine uno!"]}),!r.isEmpty(o)&&!r.isEmpty(o.negozi)&&i(A,{children:[e(p,{mb:3,children:i(c,{variant:"outlined",severity:"info",children:["Stai visualizzando i negozi de ",o.denominazione]})}),e(ne,{children:e(p,{p:2,children:e(re,{children:e(le,{children:(N=o.negozi)==null?void 0:N.map(a=>i(ce,{children:[e(h,{children:a.nome}),e(h,{sx:{width:50},align:"center",children:e(x,{color:"warning",onClick:()=>Z(a),children:e(de,{})})}),e(h,{sx:{width:50},align:"center",onClick:()=>O(a.id),children:e(x,{color:"error",children:e(me,{})})})]},a.id))})})})})]}),i(k,{open:v,onClose:d,children:[e(R,{children:e(w,{fullWidth:!0,label:"Nome",value:l.nome,error:S,onChange:T})}),e(F,{children:e(P,{fullWidth:!0,variant:"contained",onClick:b,children:"salva"})}),n&&e(W,{})]}),i(k,{open:E,onClose:d,children:[e(R,{children:e(w,{fullWidth:!0,label:"Nome",value:l.nome,error:S,onChange:T})}),e(F,{children:e(P,{fullWidth:!0,variant:"contained",onClick:H,children:"salva"})}),n&&e(W,{})]}),e(M,{open:!r.isEmpty(g),children:e(c,{severity:s?"error":"success",children:g})}),e(M,{open:!r.isEmpty(f),children:e(c,{severity:G?"error":"success",children:f})}),!r.isEmpty(o)&&e(ee,{onClick:()=>y(!0),loading:L})]})};export{De as default};
