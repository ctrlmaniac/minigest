import{bn as C,bo as S,bp as D,R as p,l as h,j as i,F as g,b as e}from"./index-d882999b.js";import{a as F,E as w}from"./index-26de8948.js";import{e as q,d as y,B as c,T as P,P as z}from"./hooks-15d50f7a.js";import{A as f}from"./Alert-37711bff.js";import{A as j}from"./AlertTitle-01a85079.js";import{I as $}from"./IconBuildingStore-9d71ca7c.js";import{G as b}from"./Grid-b855ca7a.js";import{T as E}from"./TextField-3f0953ff.js";import{T as B,a as v,b as o,c as V}from"./TableRow-d1dbbd36.js";import{T as G}from"./TableHead-90aebb17.js";import"./createReactComponent-ffa67357.js";import"./Grow-59285a38.js";import"./useFormControl-55db2a8e.js";import"./Portal-cac5f17a.js";import"./useControlled-de568f22.js";function L(u){return async t=>{t(C()),F.get(`${w.REGISTRO_CORRISPETTIVI}?${u}`).then(a=>{t(S(a.data))}).catch(a=>{let n="Errore";a.response?n=a.response.data:n="Errore",t(D(n))})}}const re=()=>{const u=q(),{selected:t}=y(r=>r.negozi),{registro:a}=y(r=>r.registroCorrispettivi),[n,x]=p.useState({negozio:t?t.id:"",anno:new Date().getFullYear(),mese:new Date().getMonth()+1}),[d,T]=p.useState({anno:!1,mese:!1});p.useEffect(()=>{h.isEmpty(t)||x({...n,negozio:t.id})},[t]);const R=r=>{const{name:s,value:m}=r.target;x({...n,[s]:m});const l=parseInt(m);s==="anno"&&T({...d,anno:l<1970||l>new Date().getFullYear()}),s==="mese"&&T({...d,mese:l<1||l>12})};return p.useEffect(()=>{const r=`negozio=${n.negozio}&anno=${n.anno}&mese=${n.mese}`;u(L(r))},[n]),i(g,{children:[e(c,{mb:3,children:e(P,{variant:"h3",children:"Registro dei Corrispettivi"})}),h.isEmpty(t)?i(f,{variant:"outlined",severity:"error",children:[e(j,{children:"Devi selezionare un negozio!"}),"Per visualizzare le chiusure fiscali devi prima selezionare un negozio. Clicca sull'icona ",e($,{})," in alto a sinistra e selezionane uno!"]}):i(g,{children:[e(c,{mb:3,children:i(f,{severity:"info",variant:"outlined",children:["Stai visualizzando il registro dei corrispettivi del negozio"," ",t.nome]})}),e(c,{mb:3,children:e(z,{children:e(c,{p:2,children:i(b,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(b,{item:!0,xs:12,sm:6,children:e(E,{label:"Anno",name:"anno",value:n.anno,error:d.anno,onChange:R,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(b,{item:!0,xs:12,sm:6,children:e(E,{label:"Mese",name:"mese",value:n.mese,error:d.mese,onChange:R,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})})]})})})}),h.isEmpty(a)?e(f,{variant:"outlined",severity:"info",children:"Non sono presenti chiusure fiscali quindi non c'è nemmeno un registro dei corrispettivi!"}):e(g,{children:e(c,{children:e(z,{children:e(c,{p:2,sx:{overflowX:"auto"},children:i(B,{children:[i(G,{children:[i(v,{children:[e(o,{colSpan:3,sx:{borderLeft:1,borderRight:1},children:"Riepilogo"}),a.aliquoteIVA.map((r,s)=>i(o,{sx:{borderRight:1},children:[r," %"]},s))]}),i(v,{children:[e(o,{sx:{borderLeft:1},children:"Data"}),e(o,{children:"Totale"}),e(o,{sx:{borderRight:1},children:"N.D.F."}),a.aliquoteIVA.map((r,s)=>e(o,{sx:{borderRight:1},children:"Totale"},s))]})]}),e(V,{children:a.corrispettivi.map((r,s)=>{const m=Object.keys(r.reparti);return i(v,{children:[e(o,{sx:{borderLeft:1},children:r.data}),i(o,{children:["€ ",r.totale]}),e(o,{sx:{borderRight:1},children:r.numeroDocFisc||0}),m.map((l,I)=>{const A=r.reparti[l];return i(o,{sx:{borderRight:1},children:["€ ",A.totale]},I)})]},s)})})]})})})})})]})]})};export{re as default};
