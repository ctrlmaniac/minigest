import{a9 as F,aa as W,ab as $,ac as D,i as N,R as l,d as m,F as P,j as a,l as B,ad as G}from"./index-f3e0e4f0.js";import{f as I,e as v,B as f,T as L,P as M}from"./hooks-0ad2b324.js";import{a as y,E as C}from"./index-88ad5ff9.js";import{G as u}from"./Grid-446aa362.js";import{T as h}from"./TextField-9ae2c48a.js";import{A as x}from"./Alert-1b6a4d3c.js";import{L as O}from"./LinearProgress-eda7bae8.js";import"./Grow-0dd1875c.js";function R(c=""){return async n=>{y.get(`${C.AUTH}?email=${c}`).then(e=>{n(F(e.data))}).catch(e=>{let s=!1;e.response?s=e.response.data:s=!1,console.log(s)})}}function U(c,n){return async e=>{e(W()),y.put(`${C.ACCOUNT}/${c}`,n).then(s=>{e($(s.data))}).catch(s=>{let o="Errore";s.response?o=s.response.data:o="Errore",e(D(o))})}}const Q=()=>{const c=N(),n=I(),{dettagli:e,updating:s,updateError:o}=v(r=>r.account),{exists:p}=v(r=>r.auth),[t,g]=l.useState({...e});l.useEffect(()=>{g({...e})},[e]);const[i,A]=l.useState({nome:!1,cognome:!1,email:!1}),d=r=>{const{name:E,value:b}=r.target;g({...t,[E]:b}),A({...i,[E]:b.toString().length<1})},[S,T]=l.useState(!0);l.useEffect(()=>{T(!Object.values(i).every(r=>r===!1))},[i]),l.useEffect(()=>{n(R(t.email))},[t]);const j=()=>{n(U(e==null?void 0:e.id,t)),setTimeout(()=>{c("/account")},1e3)};return m(P,{children:[a(f,{mb:3,children:a(L,{variant:"h3",children:"Modifica Account"})}),m(M,{children:[a(f,{p:2,children:m(u,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[a(u,{item:!0,xs:12,sm:6,children:a(h,{label:"Nome",name:"nome",value:t.nome,error:i.nome,fullWidth:!0,onChange:d})}),a(u,{item:!0,xs:12,sm:6,children:a(h,{label:"Cognome",name:"cognome",value:t.cognome,error:i.cognome,fullWidth:!0,onChange:d})}),m(u,{item:!0,xs:12,children:[a(h,{label:"Email",name:"email",value:t.email,error:i.email,fullWidth:!0,onChange:d,type:"email"}),t.email!==(e==null?void 0:e.email)&&a(x,{severity:p?"error":"success",children:p?"email non disponibile":"email disponibile"})]})]})}),s&&a(O,{})]}),!B.isEmpty(o)&&a(f,{mt:2,children:a(x,{severity:"error",children:o})}),a(G,{onClick:j,disabled:S||t.email!==(e==null?void 0:e.email)&&p})]})};export{Q as default};
