import{aH as H,aI as J,aJ as K,aK as V,aL as q,aM as Q,aN as U,R as d,d as r,F as b,j as e,l as s,ak as X,aO as I,aP as Y}from"./index-94156edf.js";import{a as w,E as R,I as A}from"./index-ceaeaac0.js";import{f as _,e as x,B as p,T as ee,P as ae}from"./hooks-bf5842b6.js";import{p as oe}from"./post-f473680e.js";import{A as m}from"./Alert-9526df75.js";import{A as B}from"./AlertTitle-d854389a.js";import{I as te}from"./IconBuildingWarehouse-f3d77fa3.js";import{T as ne,c as ie,a as re,b as h}from"./TableRow-35a584e7.js";import{I as se}from"./IconPencil-ba903bc4.js";import{I as le}from"./IconTrash-db1c12e2.js";import{a as D,b as k}from"./DialogContent-f57b4532.js";import{T as P}from"./TextField-2417de86.js";import{D as F}from"./DialogActions-2268f8ed.js";import{B as M}from"./Button-9b78c890.js";import{L as W}from"./LinearProgress-354055ec.js";import{S as ce}from"./Snackbar-0e19bbae.js";import"./createReactComponent-2aca6431.js";import"./Grow-91bcfd76.js";import"./useFormControl-dd0c56d7.js";function de(t){return async o=>{o(H()),w.delete(`${R.NEGOZI}/${t}`).then(n=>{o(J(n.data)),o(K(t))}).catch(n=>{let i="Errore";n.response?i=n.response.data:i="Errore",o(V(i))})}}function me(t){return async o=>{o(q()),w.put(`${R.NEGOZI}/${t.id}`,t).then(n=>{o(Q(n.data))}).catch(n=>{let i="Errore";n.response?i=n.response.data:i="Errore",o(U(i))})}}const Pe=()=>{var T;const t=_(),{selected:o}=x(a=>a.aziende),{putting:n,putError:i,removeError:ue,posting:$,response:g}=x(a=>a.negozi),[f,v]=d.useState(!1),[z,E]=d.useState(!1),[l,u]=d.useState({id:void 0,nome:""}),[y,S]=d.useState(!1),C=a=>{u({...l,nome:a.target.value}),S(a.target.value.toString().length<1)},j=a=>{t(de(a)),setTimeout(()=>{t(I())},2e3)},L=a=>{u({...a}),v(!0)},O=()=>{u({id:void 0,nome:""}),S(!1)},c=()=>{v(!1),E(!1),O()},N=()=>{t(me(l)),c(),setTimeout(()=>{t(I()),t(Y(l))},1e3)},G=a=>{t(oe(a)),c()},Z=()=>{if(z){const a={azienda:o,nome:l.nome};G(a)}else f&&N()};return r(b,{children:[e(p,{mb:3,children:e(ee,{variant:"h3",gutterBottom:!0,children:"Negozi"})}),s.isEmpty(o)&&r(m,{variant:"outlined",severity:"error",children:[e(B,{children:"Non hai selezionato nessuna azienda!"}),"Prima di visualizzare la lista dei negozi, seleziona l'azienda a cui appartengono. Clicca su ",e(te,{})," in alto a destra per selezionare l'azienda!"]}),!s.isEmpty(o)&&s.isEmpty(o.negozi)&&r(m,{variant:"outlined",severity:"info",children:[e(B,{children:"Non hai nessun negozio"}),"Aggiungine uno!"]}),!s.isEmpty(o)&&!s.isEmpty(o.negozi)&&r(b,{children:[e(p,{mb:3,children:r(m,{variant:"outlined",severity:"info",children:["Stai visualizzando i negozi de ",o.denominazione]})}),e(ae,{children:e(p,{p:2,children:e(ne,{children:e(ie,{children:(T=o.negozi)==null?void 0:T.map(a=>r(re,{children:[e(h,{children:a.nome}),e(h,{sx:{width:50},align:"center",children:e(A,{color:"warning",onClick:()=>L(a),children:e(se,{})})}),e(h,{sx:{width:50},align:"center",onClick:()=>j(a.id),children:e(A,{color:"error",children:e(le,{})})})]},a.id))})})})})]}),r(D,{open:f,onClose:c,children:[e(k,{children:e(P,{fullWidth:!0,label:"Nome",value:l.nome,error:y,onChange:C})}),e(F,{children:e(M,{fullWidth:!0,variant:"contained",onClick:N,children:"salva"})}),n&&e(W,{})]}),r(D,{open:z,onClose:c,children:[e(k,{children:e(P,{fullWidth:!0,label:"Nome",value:l.nome,error:y,onChange:C})}),e(F,{children:e(M,{fullWidth:!0,variant:"contained",onClick:Z,children:"salva"})}),n&&e(W,{})]}),e(ce,{open:!s.isEmpty(g),children:e(m,{severity:"info",children:g})}),!s.isEmpty(o)&&e(X,{onClick:()=>E(!0),loading:$})]})};export{Pe as default};
