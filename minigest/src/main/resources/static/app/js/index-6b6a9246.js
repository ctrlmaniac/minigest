import{Z as B,$ as j,a0 as N,i as Y,R as p,aQ as G,l,d as a,F as T,j as e,ak as H,aR as M}from"./index-6a75a5de.js";import{a as Q,E as U,I as c}from"./index-db9e3c6a.js";import{f as W,e as b,B as d,T as q,P as C}from"./hooks-8b6b3ce5.js";import{r as L}from"./remove-1a835848.js";import{A as g}from"./Alert-863a23eb.js";import{A as V}from"./AlertTitle-c2d2966c.js";import{I as Z}from"./IconBuildingStore-70e274f4.js";import{G as v}from"./Grid-f0b91695.js";import{T as F}from"./TextField-09f22a56.js";import{T as _,a as w,b as r,c as J}from"./TableRow-c65b3546.js";import{T as K}from"./TableHead-40379dbf.js";import{I as z}from"./IconFile-95cab889.js";import{I as D}from"./IconPencil-98a85a4b.js";import{I as A}from"./IconTrash-2431d59b.js";import{S as O}from"./Snackbar-c915bc05.js";import"./createReactComponent-2662947b.js";import"./Grow-234efcfb.js";import"./useFormControl-ec2a69e6.js";function X(m){return async o=>{o(B()),Q.get(`${U.CHIUSURE_FISCALI}?${m}`).then(n=>{o(j(n.data))}).catch(n=>{let s="Errore";n.response?s=n.response.data:s="Errore",o(N(s))})}}const ye=()=>{const m=Y(),o=W(),{selected:n}=b(i=>i.negozi),{list:s,removeError:P,response:y}=b(i=>i.chiusureFiscali),[t,$]=p.useState({anno:new Date().getFullYear(),mese:new Date().getMonth()+1}),[h,S]=p.useState({anno:!1,mese:!1}),[E,k]=G({anno:t.anno.toString(),mese:t.mese.toString()});p.useEffect(()=>{l.isEmpty(n)||o(X(`negozio=${n.id}&${E.toString()}`))},[n,E]);const I=i=>{const{name:f,value:x}=i.target;$({...t,[f]:x});const u=parseInt(x);f==="anno"&&S({...h,anno:u<1970||u>new Date().getFullYear()}),f==="mese"&&S({...h,mese:u<1||u>12})};p.useEffect(()=>{k({anno:t.anno.toString(),mese:t.mese.toString()})},[t]);const R=i=>{o(L(i)),setTimeout(()=>{o(M())},1e3)};return a(T,{children:[e(d,{mb:3,children:e(q,{variant:"h3",children:"Chiusure Fiscali"})}),l.isEmpty(n)&&a(g,{variant:"outlined",severity:"error",children:[e(V,{children:"Devi selezionare un negozio!"}),"Per visualizzare le chiusure fiscali devi prima selezionare un negozio. Clicca sull'icona ",e(Z,{})," in alto a sinistra e selezionane uno!"]}),!l.isEmpty(n)&&a(T,{children:[e(d,{mb:3,children:a(g,{severity:"info",variant:"outlined",children:["Stai visualizzando le chiusure fiscali del negozio ",n.nome]})}),e(d,{mb:3,children:e(C,{children:e(d,{p:2,children:a(v,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Anno",name:"anno",value:t.anno,error:h.anno,onChange:I,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Mese",name:"mese",value:t.mese,error:h.mese,onChange:I,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})})]})})})}),l.isEmpty(s)?e(g,{variant:"outlined",severity:"info",children:"Non sono presenti chiusure fiscali! Aggiungine una!"}):e(d,{children:e(C,{children:e(d,{p:2,children:a(_,{children:[e(K,{children:a(w,{children:[e(r,{children:"Data"}),e(r,{children:"Totale"}),e(r,{children:"N.D.F"}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(D,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(A,{})})})]})}),e(J,{children:s==null?void 0:s.map(i=>a(w,{children:[e(r,{children:i.data}),a(r,{children:["â‚¬ ",i.totale]}),e(r,{children:i.numeroDocFisc}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"info",onClick:()=>m(`dettagli/${i.id}`),children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"warning",onClick:()=>m(`modifica/${i.id}`),children:e(D,{})})}),e(r,{children:e(c,{color:"error",onClick:()=>R(i.id),children:e(A,{})})})]},i.id))})]})})})}),e(O,{open:!l.isEmpty(y),children:e(g,{severity:P?"error":"success",children:y})})]}),!l.isEmpty(n)&&e(H,{onClick:()=>m("aggiungi")})]})};export{ye as default};
