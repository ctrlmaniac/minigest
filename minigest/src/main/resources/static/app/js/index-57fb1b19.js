import{at as w,au as G,av as K,i as $,R as p,d as P,F as M,j as e,l as A,a7 as Z,ak as H,ai as J,B as L,V as Q}from"./index-c637eda0.js";import{g as U}from"./get-9b8d1202.js";import{f as W,e as T,B as F,T as X,P as Y}from"./hooks-edca5f41.js";import{a as _}from"./exists-ba56e09f.js";import{a as ee,E as ie}from"./index-450aab6b.js";import{G as a}from"./Grid-570fa523.js";import{T as t}from"./TextField-3b54eb4a.js";import{A as y}from"./Alert-ab1cdef6.js";import{S as ae}from"./Snackbar-b1c4388f.js";function ne(i,f){return async s=>{s(w()),ee.put(`${ie.AZIENDE}/${i}`,f).then(r=>{s(G(r.data))}).catch(r=>{let u="Errore";r.response?u=r.response.data:u="Errore",s(K(u))})}}const se=({dettagli:i})=>{var E,I,b,x,V,S;const f=$(),s=W(),{exists:r,putting:u,putError:C,putResponse:g}=T(l=>l.aziende),[n,j]=p.useState({denominazione:i.denominazione,idFiscaleIVAPaese:i.idFiscaleIVAPaese,idFiscaleIVACodice:i.idFiscaleIVACodice,codiceFiscale:i.codiceFiscale}),[h,N]=p.useState({denominazione:!1,idFiscaleIVAPaese:!1,idFiscaleIVACodice:!1,codiceFiscale:!1});p.useEffect(()=>{s(_(n.idFiscaleIVAPaese,n.idFiscaleIVACodice))},[n]);const v=l=>{const{name:o,value:d}=l.target;j({...n,[o]:d}),N({...h,[o]:d.toString().length<1})},[m,q]=p.useState({indirizzo:(E=i.sede)==null?void 0:E.indirizzo,numeroCivico:(I=i.sede)==null?void 0:I.numeroCivico,cap:(b=i.sede)==null?void 0:b.cap,comune:(x=i.sede)==null?void 0:x.comune,provincia:(V=i.sede)==null?void 0:V.provincia,nazione:(S=i.sede)==null?void 0:S.nazione}),[c,B]=p.useState({indirizzo:!1,numeroCivico:!1,cap:!1,comune:!1,provincia:!1,nazione:!1}),z=l=>{const{name:o,value:d,required:k}=l.target;q({...m,[o]:d}),k&&B({...c,[o]:d.toString().length<1})},[D,O]=p.useState(!0);p.useEffect(()=>{const l=!Object.values(h).every(d=>d===!1),o=!Object.values(c).every(d=>d===!1);O(l||o)},[h,c]);const R=()=>{var o;const l={...n,sede:{id:(o=i.sede)==null?void 0:o.id,...m}};s(ne(i.id,l)),setTimeout(()=>{s(H()),f("/aziende")},1e3)};return P(M,{children:[e(F,{mb:3,children:e(X,{variant:"h3",children:"Aggiungi Azienda"})}),e(F,{mb:3,children:e(Y,{children:e(F,{p:2,children:P(a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e(a,{item:!0,xs:12,children:e(t,{label:"Denominazione o Nome e Cognome",name:"denominazione",value:n.denominazione,error:h.denominazione,fullWidth:!0,onChange:v})}),e(a,{item:!0,xs:2,children:e(t,{label:"Nazione",name:"idFiscaleIVAPaese",value:n.idFiscaleIVAPaese,error:h.idFiscaleIVAPaese,fullWidth:!0,onChange:v})}),e(a,{item:!0,xs:10,children:e(t,{label:"Partita IVA",name:"idFiscaleIVACodice",value:n.idFiscaleIVACodice,error:h.idFiscaleIVACodice,fullWidth:!0,onChange:v})}),e(a,{item:!0,xs:12,children:n.idFiscaleIVAPaese!==i.idFiscaleIVAPaese&&n.idFiscaleIVACodice!==i.idFiscaleIVACodice&&e(y,{severity:r?"error":"success",children:r?"Azienda giÃ  esistente!":"Azienda disponibile"})}),e(a,{item:!0,xs:12,children:e(t,{label:"Codice Fiscale",name:"codiceFiscale",value:n.codiceFiscale,error:h.codiceFiscale,fullWidth:!0,onChange:v})}),e(a,{item:!0,xs:10,children:e(t,{fullWidth:!0,label:"Indirizzo",name:"indirizzo",value:m.indirizzo,error:c.indirizzo,required:!0,onChange:z})}),e(a,{item:!0,xs:2,children:e(t,{fullWidth:!0,label:"N. Civico",name:"numeroCivico",value:m.numeroCivico,error:c.numeroCivico,onChange:z})}),e(a,{item:!0,xs:12,sm:6,children:e(t,{fullWidth:!0,label:"CAP",name:"cap",value:m.cap,error:c.cap,required:!0,onChange:z})}),e(a,{item:!0,xs:12,sm:6,children:e(t,{fullWidth:!0,label:"Comune",name:"comune",value:m.comune,error:c.comune,required:!0,onChange:z})}),e(a,{item:!0,xs:12,sm:6,children:e(t,{fullWidth:!0,label:"Provincia",name:"provincia",value:m.provincia,error:c.provincia,onChange:z,helperText:"Esempio: BS"})}),e(a,{item:!0,xs:12,sm:6,children:e(t,{fullWidth:!0,label:"Nazione",name:"nazione",value:m.nazione,error:c.nazione,onChange:z,required:!0,helperText:"Esempio: IT"})})]})})})}),e(ae,{open:!A.isEmpty(g),children:e(y,{severity:C?"error":"info",children:g})}),e(Z,{onClick:R,disabled:r||D,loading:u})]})},he=()=>{const i=W(),{id:f}=J(),{dettagli:s,getting:r,getError:u}=T(C=>C.aziende);return p.useEffect(()=>{A.isEmpty(f)||i(U(f))},[]),r?e(L,{}):!A.isEmpty(u)||A.isEmpty(s)?e(Q,{message:u||"Errore di caricamento"}):e(se,{dettagli:s})};export{he as default};
