import{a9 as F,aa as W,ab as $,ac as D,i as N,R as l,d as m,F as P,j as s,l as B,ad as G}from"./index-2aee8fbc.js";import{f as I,e as b,B as d,T as L,P as M}from"./hooks-ac52b7c3.js";import{a as x,E as y}from"./index-d540e9b2.js";import{G as u}from"./Grid-75cf535a.js";import{T as f}from"./TextField-2b7385a2.js";import{A as v}from"./Alert-442bcf26.js";import{L as O}from"./LinearProgress-8407fe2d.js";import"./Grow-60e7aeaa.js";function R(c=""){return async r=>{x.get(`${y.AUTH}?email=${c}`).then(e=>{r(F(e.data))}).catch(e=>{let a=!1;e.response?a=e.response.data:a=!1,console.log(a)})}}function U(c,r){return async e=>{e(W()),x.put(`${y.ACCOUNT}/${c}`,r).then(a=>{e($(a.data))}).catch(a=>{let t="Errore";a.response?t=a.response.data:t="Errore",e(D(t))})}}const Q=()=>{const c=N(),r=I(),{dettagli:e,updating:a,updateError:t}=b(o=>o.account),{exists:p}=b(o=>o.auth),[n,C]=l.useState({nome:e==null?void 0:e.nome,cognome:e==null?void 0:e.cognome,email:e==null?void 0:e.email}),[i,A]=l.useState({nome:!1,cognome:!1,email:!1}),h=o=>{const{name:g,value:E}=o.target;C({...n,[g]:E}),A({...i,[g]:E.toString().length<1})},[S,T]=l.useState(!0);l.useEffect(()=>{T(!Object.values(i).every(o=>o===!1))},[i]),l.useEffect(()=>{r(R(n.email))},[n]);const j=()=>{r(U(e==null?void 0:e.id,n)),setTimeout(()=>{c("/account")},1e3)};return m(P,{children:[s(d,{mb:3,children:s(L,{variant:"h3",children:"Modifica Account"})}),m(M,{children:[s(d,{p:2,children:m(u,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[s(u,{item:!0,xs:12,sm:6,children:s(f,{label:"Nome",name:"nome",value:n.nome,error:i.nome,fullWidth:!0,onChange:h})}),s(u,{item:!0,xs:12,sm:6,children:s(f,{label:"Cognome",name:"cognome",value:n.cognome,error:i.cognome,fullWidth:!0,onChange:h})}),m(u,{item:!0,xs:12,children:[s(f,{label:"Email",name:"email",value:n.email,error:i.email,fullWidth:!0,onChange:h,type:"email"}),n.email!==(e==null?void 0:e.email)&&s(v,{severity:p?"error":"success",children:p?"email non disponibile":"email disponibile"})]})]})}),a&&s(O,{})]}),!B.isEmpty(t)&&s(d,{mt:2,children:s(v,{severity:"error",children:t})}),s(G,{onClick:j,disabled:S||n.email!==(e==null?void 0:e.email)&&p})]})};export{Q as default};
