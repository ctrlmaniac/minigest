import{a3 as F,a4 as W,a5 as $,a6 as D,i as N,R as c,d as m,F as P,j as s,l as B,a7 as G}from"./index-8d810eb5.js";import{f as I,e as v,B as f,T as L,P as M}from"./hooks-29c1883f.js";import{a as b,E as y}from"./index-369028e4.js";import{G as u}from"./Grid-a6d2df67.js";import{T as d}from"./TextField-19a3feee.js";import{A as x}from"./Alert-ac51448d.js";import{L as O}from"./LinearProgress-b48b32c5.js";function R(l=""){return async r=>{b.get(`${y.AUTH}?email=${l}`).then(e=>{r(F(e.data))}).catch(e=>{let a=!1;e.response?a=e.response.data:a=!1,console.log(a)})}}function U(l,r){return async e=>{e(W()),b.put(`${y.ACCOUNT}/${l}`,r).then(a=>{e($(a.data))}).catch(a=>{let t="Errore";a.response?t=a.response.data:t="Errore",e(D(t))})}}const K=()=>{const l=N(),r=I(),{dettagli:e,updating:a,updateError:t}=v(o=>o.account),{exists:p}=v(o=>o.auth),[n,C]=c.useState({nome:e==null?void 0:e.nome,cognome:e==null?void 0:e.cognome,email:e==null?void 0:e.email}),[i,A]=c.useState({nome:!1,cognome:!1,email:!1}),h=o=>{const{name:g,value:E}=o.target;C({...n,[g]:E}),A({...i,[g]:E.toString().length<1})},[S,T]=c.useState(!0);c.useEffect(()=>{T(!Object.values(i).every(o=>o===!1))},[i]),c.useEffect(()=>{r(R(n.email))},[n]);const j=()=>{r(U(e==null?void 0:e.id,n)),setTimeout(()=>{l("/account")},1e3)};return m(P,{children:[s(f,{mb:3,children:s(L,{variant:"h3",children:"Modifica Account"})}),m(M,{children:[s(f,{p:2,children:m(u,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[s(u,{item:!0,xs:12,sm:6,children:s(d,{label:"Nome",name:"nome",value:n.nome,error:i.nome,fullWidth:!0,onChange:h})}),s(u,{item:!0,xs:12,sm:6,children:s(d,{label:"Cognome",name:"cognome",value:n.cognome,error:i.cognome,fullWidth:!0,onChange:h})}),m(u,{item:!0,xs:12,children:[s(d,{label:"Email",name:"email",value:n.email,error:i.email,fullWidth:!0,onChange:h,type:"email"}),n.email!==(e==null?void 0:e.email)&&s(x,{severity:p?"error":"success",children:p?"email non disponibile":"email disponibile"})]})]})}),a&&s(O,{})]}),!B.isEmpty(t)&&s(f,{mt:2,children:s(x,{severity:"error",children:t})}),s(G,{onClick:j,disabled:S||n.email!==(e==null?void 0:e.email)&&p})]})};export{K as default};
