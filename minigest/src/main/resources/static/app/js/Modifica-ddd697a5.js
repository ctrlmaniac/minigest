import{ae as $,af as j,ag as F,ah as W,f as D,R as l,j as m,F as N,b as a,l as P,ai as B}from"./index-cdd6c92c.js";import{e as G,d as v,B as h,T as I,P as L}from"./hooks-7529384b.js";import{a as z,E as C}from"./index-2712c8cb.js";import{G as u}from"./Grid-0170c88c.js";import{T as g}from"./TextField-c74aca9e.js";import{A as y}from"./Alert-ed83c53c.js";import{L as M}from"./LinearProgress-633fc854.js";import"./Grow-63e57ca1.js";import"./useFormControl-745ed0b2.js";import"./Portal-6e248c94.js";import"./useControlled-168d430d.js";function O(c=""){return async o=>{z.get(`${C.AUTH}?email=${c}`).then(e=>{o($(e.data))}).catch(e=>{let s=!1;e.response?s=e.response.data:s=!1,console.log(s)})}}function R(c,o){return async e=>{e(j()),z.put(`${C.ACCOUNT}/${c}`,o).then(s=>{e(F(s.data))}).catch(s=>{let i="Errore";s.response?i=s.response.data:i="Errore",e(W(i))})}}const Z=()=>{const c=D(),o=G(),{dettagli:e,updating:s,updateError:i}=v(n=>n.account),{exists:x}=v(n=>n.auth),[t,b]=l.useState({...e});l.useEffect(()=>{b({...e})},[e]);const[r,E]=l.useState({nome:!1,cognome:!1,email:!1}),f=n=>{const{name:p,value:d}=n.target;b({...t,[p]:d}),E(p==="email"?{...r,email:!/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(d)}:{...r,[p]:d.toString().length<1})},[A,S]=l.useState(!0);l.useEffect(()=>{S(!Object.values(r).every(n=>n===!1))},[r]),l.useEffect(()=>{o(O(t.email))},[t]);const T=()=>{o(R(e==null?void 0:e.id,t)),setTimeout(()=>{c("/account")},1e3)};return m(N,{children:[a(h,{mb:3,children:a(I,{variant:"h3",children:"Modifica Account"})}),m(L,{children:[a(h,{p:2,children:m(u,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[a(u,{item:!0,xs:12,sm:6,children:a(g,{label:"Nome",name:"nome",value:t.nome,error:r.nome,fullWidth:!0,onChange:f})}),a(u,{item:!0,xs:12,sm:6,children:a(g,{label:"Cognome",name:"cognome",value:t.cognome,error:r.cognome,fullWidth:!0,onChange:f})}),m(u,{item:!0,xs:12,children:[a(g,{label:"Email",name:"email",value:t.email,error:r.email,fullWidth:!0,onChange:f,type:"email",helperText:r.email?"email non conforme":""}),t.email!==(e==null?void 0:e.email)&&a(y,{severity:x?"error":"success",children:x?"email non disponibile":"email disponibile"})]})]})}),s&&a(M,{})]}),!P.isEmpty(i)&&a(h,{mt:2,children:a(y,{severity:"error",children:i})}),a(B,{onClick:T,disabled:A||t.email!==(e==null?void 0:e.email)&&x})]})};export{Z as default};
