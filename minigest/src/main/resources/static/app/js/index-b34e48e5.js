import{Z as R,$ as j,a0 as M,i as N,R as p,aL as Y,l,d as a,F as T,j as e,af as G,aM as H}from"./index-2aee8fbc.js";import{a as L,E as U,I as c}from"./index-d540e9b2.js";import{f as W,e as b,B as d,T as q,P as C}from"./hooks-ac52b7c3.js";import{r as Q}from"./remove-cb252165.js";import{A as g}from"./Alert-442bcf26.js";import{A as V}from"./AlertTitle-aa3a6f5b.js";import{I as Z}from"./IconBuildingStore-d808538a.js";import{G as v}from"./Grid-75cf535a.js";import{T as F}from"./TextField-2b7385a2.js";import{T as _,a as w,b as r,c as J}from"./TableRow-4c838dfa.js";import{T as K}from"./TableHead-d6dd838d.js";import{I as z}from"./IconFile-096a5c9f.js";import{I as D}from"./IconPencil-16693be1.js";import{I as A}from"./IconTrash-b259a790.js";import{S as O}from"./Snackbar-6116d8ac.js";import"./createReactComponent-c382b839.js";import"./Grow-60e7aeaa.js";function X(m){return async o=>{o(R()),L.get(`${U.CHIUSURE_FISCALI}?${m}`).then(i=>{o(j(i.data))}).catch(i=>{let s="Errore";i.response?s=i.response.data:s="Errore",o(M(s))})}}const ve=()=>{const m=N(),o=W(),{selected:i}=b(n=>n.negozi),{list:s,removeError:P,response:y}=b(n=>n.chiusureFiscali),[t,$]=p.useState({anno:new Date().getFullYear(),mese:new Date().getMonth()+1}),[h,S]=p.useState({anno:!1,mese:!1}),[E,k]=Y({anno:t.anno.toString(),mese:t.mese.toString()});p.useEffect(()=>{l.isEmpty(i)||o(X(`negozio=${i.id}&${E.toString()}`))},[i,E]);const I=n=>{const{name:f,value:x}=n.target;$({...t,[f]:x});const u=parseInt(x);f==="anno"&&S({...h,anno:u<1970||u>new Date().getFullYear()}),f==="mese"&&S({...h,mese:u<1||u>12})};p.useEffect(()=>{k({anno:t.anno.toString(),mese:t.mese.toString()})},[t]);const B=n=>{o(Q(n)),setTimeout(()=>{o(H())},1e3)};return a(T,{children:[e(d,{mb:3,children:e(q,{variant:"h3",children:"Chiusure Fiscali"})}),l.isEmpty(i)&&a(g,{variant:"outlined",severity:"error",children:[e(V,{children:"Devi selezionare un negozio!"}),"Per visualizzare le chiusure fiscali devi prima selezionare un negozio. Clicca sull'icona ",e(Z,{})," in alto a sinistra e selezionane uno!"]}),!l.isEmpty(i)&&a(T,{children:[e(d,{mb:3,children:a(g,{severity:"info",variant:"outlined",children:["Stai visualizzando le chiusure fiscali del negozio ",i.nome]})}),e(d,{mb:3,children:e(C,{children:e(d,{p:2,children:a(v,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Anno",name:"anno",value:t.anno,error:h.anno,onChange:I,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Mese",name:"mese",value:t.mese,error:h.mese,onChange:I,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})})]})})})}),l.isEmpty(s)?e(g,{variant:"outlined",severity:"info",children:"Non sono presenti chiusure fiscali! Aggiungine una!"}):e(d,{children:e(C,{children:e(d,{p:2,children:a(_,{children:[e(K,{children:a(w,{children:[e(r,{children:"Data"}),e(r,{children:"Totale"}),e(r,{children:"N.D.F"}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(D,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(A,{})})})]})}),e(J,{children:s==null?void 0:s.map(n=>a(w,{children:[e(r,{children:n.data}),a(r,{children:["â‚¬ ",n.totale]}),e(r,{children:n.numeroDocFisc}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"info",onClick:()=>m(`dettagli/${n.id}`),children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"warning",onClick:()=>m(`modifica/${n.id}`),children:e(D,{})})}),e(r,{children:e(c,{color:"error",onClick:()=>B(n.id),children:e(A,{})})})]},n.id))})]})})})}),e(O,{open:!l.isEmpty(y),children:e(g,{severity:P?"error":"success",children:y})})]}),!l.isEmpty(i)&&e(G,{onClick:()=>m("aggiungi")})]})};export{ve as default};
