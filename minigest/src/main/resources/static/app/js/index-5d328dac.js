import{Z as B,$ as j,a0 as N,f as Y,R as p,aQ as G,l,j as a,F as x,b as e,ak as H,aR as M}from"./index-b0edc525.js";import{a as Q,E as U,I as c}from"./index-c1f533ec.js";import{e as W,d as T,B as m,T as q,P as C}from"./hooks-f9dc248c.js";import{r as L}from"./remove-7eea0840.js";import{A as g}from"./Alert-bf912103.js";import{A as V}from"./AlertTitle-cc53b190.js";import{I as Z}from"./IconBuildingStore-e617b86f.js";import{G as v}from"./Grid-6e4f877e.js";import{T as F}from"./TextField-11ad0b6f.js";import{T as _,a as w,b as r,c as J}from"./TableRow-1c21061b.js";import{T as K}from"./TableHead-339200f6.js";import{I as z}from"./IconFile-f40274b7.js";import{I as D}from"./IconPencil-395fbf09.js";import{I as A}from"./IconTrash-5556d2d5.js";import{S as O}from"./Snackbar-c1499bfb.js";import"./createReactComponent-9058c6b6.js";import"./Grow-f5e1a89c.js";import"./useFormControl-1aadaf80.js";import"./Portal-3b6c3c12.js";import"./useControlled-467ac937.js";function X(d){return async o=>{o(B()),Q.get(`${U.CHIUSURE_FISCALI}?${d}`).then(n=>{o(j(n.data))}).catch(n=>{let t="Errore";n.response?t=n.response.data:t="Errore",o(N(t))})}}const Ee=()=>{const d=Y(),o=W(),{selected:n}=T(i=>i.negozi),{list:t,removeError:P,response:y}=T(i=>i.chiusureFiscali),[s,$]=p.useState({anno:new Date().getFullYear(),mese:new Date().getMonth()+1}),[h,S]=p.useState({anno:!1,mese:!1}),[E,k]=G({anno:s.anno.toString(),mese:s.mese.toString()});p.useEffect(()=>{l.isEmpty(n)||o(X(`negozio=${n.id}&${E.toString()}`))},[n,E]);const I=i=>{const{name:f,value:b}=i.target;$({...s,[f]:b});const u=parseInt(b);f==="anno"&&S({...h,anno:u<1970||u>new Date().getFullYear()}),f==="mese"&&S({...h,mese:u<1||u>12})};p.useEffect(()=>{k({anno:s.anno.toString(),mese:s.mese.toString()})},[s]);const R=i=>{o(L(i)),setTimeout(()=>{o(M())},1e3)};return a(x,{children:[e(m,{mb:3,children:e(q,{variant:"h3",children:"Chiusure Fiscali"})}),l.isEmpty(n)&&a(g,{variant:"outlined",severity:"error",children:[e(V,{children:"Devi selezionare un negozio!"}),"Per visualizzare le chiusure fiscali devi prima selezionare un negozio. Clicca sull'icona ",e(Z,{})," in alto a sinistra e selezionane uno!"]}),!l.isEmpty(n)&&a(x,{children:[e(m,{mb:3,children:a(g,{severity:"info",variant:"outlined",children:["Stai visualizzando le chiusure fiscali del negozio ",n.nome]})}),e(m,{mb:3,children:e(C,{children:e(m,{p:2,children:a(v,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",spacing:2,children:[e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Anno",name:"anno",value:s.anno,error:h.anno,onChange:I,type:"number",inputProps:{step:1,min:1970,max:new Date().getFullYear()},fullWidth:!0})}),e(v,{item:!0,xs:12,sm:6,children:e(F,{label:"Mese",name:"mese",value:s.mese,error:h.mese,onChange:I,type:"number",inputProps:{step:1,min:1,max:12},fullWidth:!0})})]})})})}),l.isEmpty(t)?e(g,{variant:"outlined",severity:"info",children:"Non sono presenti chiusure fiscali! Aggiungine una!"}):e(m,{children:e(C,{children:e(m,{p:2,children:a(_,{children:[e(K,{children:a(w,{children:[e(r,{children:"Data"}),e(r,{children:"Totale"}),e(r,{children:"N.D.F"}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(D,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{children:e(A,{})})})]})}),e(J,{children:t==null?void 0:t.map(i=>a(w,{children:[e(r,{children:i.data}),a(r,{children:["â‚¬ ",i.totale]}),e(r,{children:i.numeroDocFisc}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"info",onClick:()=>d(`dettagli/${i.id}`),children:e(z,{})})}),e(r,{sx:{width:50},align:"center",children:e(c,{color:"warning",onClick:()=>d(`modifica/${i.id}`),children:e(D,{})})}),e(r,{children:e(c,{color:"error",onClick:()=>R(i.id),children:e(A,{})})})]},i.id))})]})})})}),e(O,{open:!l.isEmpty(y),children:e(g,{severity:P?"error":"success",children:y})})]}),!l.isEmpty(n)&&e(H,{onClick:()=>d("aggiungi")})]})};export{Ee as default};
