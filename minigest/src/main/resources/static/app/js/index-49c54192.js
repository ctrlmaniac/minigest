import{aH as H,aI as J,aJ as K,aK as V,aL as q,aM as Q,aN as U,R as d,j as r,F as T,b as e,l as s,ak as X,aO as I,aP as Y}from"./index-740a6878.js";import{a as w,E as R,I as A}from"./index-db60e9b4.js";import{e as _,d as x,B as u,T as ee,P as ae}from"./hooks-18cf1700.js";import{p as oe}from"./post-384e112f.js";import{A as m}from"./Alert-85c30c87.js";import{A as B}from"./AlertTitle-455a9845.js";import{I as te}from"./IconBuildingWarehouse-b0fbba96.js";import{T as ne,c as ie,a as re,b as h}from"./TableRow-89f58786.js";import{I as se}from"./IconPencil-43216a19.js";import{I as le}from"./IconTrash-40ee9b1e.js";import{a as D,b as k}from"./DialogContent-66705bf0.js";import{T as P}from"./TextField-45cdba42.js";import{D as F}from"./DialogActions-9f0a4cb7.js";import{B as M}from"./Button-9e00729a.js";import{L as W}from"./LinearProgress-b5130941.js";import{S as ce}from"./Snackbar-17246dc3.js";import"./createReactComponent-49648c72.js";import"./Grow-d6fafe96.js";import"./Portal-40041d58.js";import"./useFormControl-16508942.js";import"./useControlled-cd9b7576.js";function de(t){return async o=>{o(H()),w.delete(`${R.NEGOZI}/${t}`).then(n=>{o(J(n.data)),o(K(t))}).catch(n=>{let i="Errore";n.response?i=n.response.data:i="Errore",o(V(i))})}}function me(t){return async o=>{o(q()),w.put(`${R.NEGOZI}/${t.id}`,t).then(n=>{o(Q(n.data))}).catch(n=>{let i="Errore";n.response?i=n.response.data:i="Errore",o(U(i))})}}const Me=()=>{var N;const t=_(),{selected:o}=x(a=>a.aziende),{putting:n,putError:i,removeError:pe,posting:$,response:g}=x(a=>a.negozi),[f,v]=d.useState(!1),[z,E]=d.useState(!1),[l,p]=d.useState({id:void 0,nome:""}),[y,S]=d.useState(!1),C=a=>{p({...l,nome:a.target.value}),S(a.target.value.toString().length<1)},j=a=>{t(de(a)),setTimeout(()=>{t(I())},2e3)},L=a=>{p({...a}),v(!0)},O=()=>{p({id:void 0,nome:""}),S(!1)},c=()=>{v(!1),E(!1),O()},b=()=>{t(me(l)),c(),setTimeout(()=>{t(I()),t(Y(l))},1e3)},G=a=>{t(oe(a)),c()},Z=()=>{if(z){const a={azienda:o,nome:l.nome};G(a)}else f&&b()};return r(T,{children:[e(u,{mb:3,children:e(ee,{variant:"h3",gutterBottom:!0,children:"Negozi"})}),s.isEmpty(o)&&r(m,{variant:"outlined",severity:"error",children:[e(B,{children:"Non hai selezionato nessuna azienda!"}),"Prima di visualizzare la lista dei negozi, seleziona l'azienda a cui appartengono. Clicca su ",e(te,{})," in alto a destra per selezionare l'azienda!"]}),!s.isEmpty(o)&&s.isEmpty(o.negozi)&&r(m,{variant:"outlined",severity:"info",children:[e(B,{children:"Non hai nessun negozio"}),"Aggiungine uno!"]}),!s.isEmpty(o)&&!s.isEmpty(o.negozi)&&r(T,{children:[e(u,{mb:3,children:r(m,{variant:"outlined",severity:"info",children:["Stai visualizzando i negozi de ",o.denominazione]})}),e(ae,{children:e(u,{p:2,children:e(ne,{children:e(ie,{children:(N=o.negozi)==null?void 0:N.map(a=>r(re,{children:[e(h,{children:a.nome}),e(h,{sx:{width:50},align:"center",children:e(A,{color:"warning",onClick:()=>L(a),children:e(se,{})})}),e(h,{sx:{width:50},align:"center",onClick:()=>j(a.id),children:e(A,{color:"error",children:e(le,{})})})]},a.id))})})})})]}),r(D,{open:f,onClose:c,children:[e(k,{children:e(P,{fullWidth:!0,label:"Nome",value:l.nome,error:y,onChange:C})}),e(F,{children:e(M,{fullWidth:!0,variant:"contained",onClick:b,children:"salva"})}),n&&e(W,{})]}),r(D,{open:z,onClose:c,children:[e(k,{children:e(P,{fullWidth:!0,label:"Nome",value:l.nome,error:y,onChange:C})}),e(F,{children:e(M,{fullWidth:!0,variant:"contained",onClick:Z,children:"salva"})}),n&&e(W,{})]}),e(ce,{open:!s.isEmpty(g),children:e(m,{severity:"info",children:g})}),!s.isEmpty(o)&&e(X,{onClick:()=>E(!0),loading:$})]})};export{Me as default};
