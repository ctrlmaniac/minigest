import{aw as J,ax as K,ay as Q,az as U,aA as X,aB as Y,aC as _,R as m,d as i,F as A,j as e,l as s,a9 as ee,aD as I,aE as ae}from"./index-8d810eb5.js";import{a as $,E as j,I as x}from"./index-369028e4.js";import{f as oe,e as B,B as p,T as te,P as ne}from"./hooks-29c1883f.js";import{p as re}from"./post-08831d5a.js";import{A as c}from"./Alert-ac51448d.js";import{A as D}from"./AlertTitle-a40df185.js";import{I as ie}from"./IconBuildingWarehouse-143fe000.js";import{T as se,a as le,b as ce,c as h}from"./TableRow-7bd9e227.js";import{I as de}from"./IconPencil-117db179.js";import{I as me}from"./IconTrash-77e3418a.js";import{a as k,b as R}from"./DialogContent-c0f22f68.js";import{T as w}from"./TextField-19a3feee.js";import{D as F}from"./DialogActions-aac5d650.js";import{B as P}from"./Button-09a45d57.js";import{L as W}from"./LinearProgress-b48b32c5.js";import{S as M}from"./Snackbar-ee143c36.js";import"./createReactComponent-fd9b34e9.js";function ue(t){return async o=>{o(J()),$.delete(`${j.NEGOZI}/${t}`).then(n=>{o(K(n.data)),o(Q(t))}).catch(n=>{let r="Errore";n.response?r=n.response.data:r="Errore",o(U(r))})}}function pe(t){return async o=>{o(X()),$.put(`${j.NEGOZI}/${t.id}`,t).then(n=>{o(Y(n.data))}).catch(n=>{let r="Errore";n.response?r=n.response.data:r="Errore",o(_(r))})}}const ke=()=>{var N;const t=oe(),{selected:o}=B(a=>a.aziende),{putting:n,putError:r,putResponse:g,removeError:G,removeResponse:f,posting:L}=B(a=>a.negozi),[v,z]=m.useState(!1),[E,y]=m.useState(!1),[l,u]=m.useState({id:void 0,nome:""}),[S,C]=m.useState(!1),T=a=>{u({...l,nome:a.target.value}),C(a.target.value.toString().length<1)},O=a=>{t(ue(a)),setTimeout(()=>{t(I())},2e3)},Z=a=>{u({...a}),z(!0)},V=()=>{u({id:void 0,nome:""}),C(!1)},d=()=>{z(!1),y(!1),V()},b=()=>{t(pe(l)),d(),setTimeout(()=>{t(I()),t(ae(l))},1e3)},q=a=>{t(re(a)),d()},H=()=>{if(E){const a={azienda:o,nome:l.nome};q(a)}else v&&b()};return i(A,{children:[e(p,{mb:3,children:e(te,{variant:"h3",gutterBottom:!0,children:"Negozi"})}),s.isEmpty(o)&&i(c,{variant:"outlined",severity:"error",children:[e(D,{children:"Non hai selezionato nessuna azienda!"}),"Prima di visualizzare la lista dei negozi, seleziona l'azienda a cui appartengono. Clicca su ",e(ie,{})," in alto a destra per selezionare l'azienda!"]}),!s.isEmpty(o)&&s.isEmpty(o.negozi)&&i(c,{variant:"outlined",severity:"info",children:[e(D,{children:"Non hai nessun negozio"}),"Aggiungine uno!"]}),!s.isEmpty(o)&&!s.isEmpty(o.negozi)&&i(A,{children:[e(p,{mb:3,children:i(c,{variant:"outlined",severity:"info",children:["Stai visualizzando i negozi de ",o.denominazione]})}),e(ne,{children:e(p,{p:2,children:e(se,{children:e(le,{children:(N=o.negozi)==null?void 0:N.map(a=>i(ce,{children:[e(h,{children:a.nome}),e(h,{sx:{width:50},align:"center",children:e(x,{color:"warning",onClick:()=>Z(a),children:e(de,{})})}),e(h,{sx:{width:50},align:"center",onClick:()=>O(a.id),children:e(x,{color:"error",children:e(me,{})})})]},a.id))})})})})]}),i(k,{open:v,onClose:d,children:[e(R,{children:e(w,{fullWidth:!0,label:"Nome",value:l.nome,error:S,onChange:T})}),e(F,{children:e(P,{fullWidth:!0,variant:"contained",onClick:b,children:"salva"})}),n&&e(W,{})]}),i(k,{open:E,onClose:d,children:[e(R,{children:e(w,{fullWidth:!0,label:"Nome",value:l.nome,error:S,onChange:T})}),e(F,{children:e(P,{fullWidth:!0,variant:"contained",onClick:H,children:"salva"})}),n&&e(W,{})]}),e(M,{open:!s.isEmpty(g),children:e(c,{severity:r?"error":"success",children:g})}),e(M,{open:!s.isEmpty(f),children:e(c,{severity:G?"error":"success",children:f})}),!s.isEmpty(o)&&e(ee,{onClick:()=>y(!0),loading:L})]})};export{ke as default};
