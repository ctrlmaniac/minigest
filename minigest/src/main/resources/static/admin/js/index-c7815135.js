import{ar as w,as as G,at as K,f as $,R as h,e as W,F as M,j as e,E as A,a4 as Z,ah as H,a1 as J,a2 as L,a3 as Q}from"./index-208ea347.js";import{g as U}from"./get-0f452e08.js";import{a as X,E as Y,u as j,b as N,A as T}from"./hooks-8a2df742.js";import{a as _,G as s}from"./exists-09199afc.js";import{B as F,T as ee}from"./Box-8244fc21.js";import{P as ie}from"./List-e3bb4bbe.js";import{T as l}from"./TextField-31ccdb21.js";import{S as ae}from"./Snackbar-576e9a4e.js";import"./Modal-834ad102.js";function ne(i,f){return async t=>{t(w()),X.put(`${Y.AZIENDE}/${i}`,f).then(c=>{t(G(c.data))}).catch(c=>{let u="Errore";c.response?u=c.response.data:u="Errore",t(K(u))})}}const re=({dettagli:i})=>{var S,b,V,x,P,y;const f=$(),t=j(),{exists:c,putting:u,putError:C,putResponse:I}=N(d=>d.aziende),[o,q]=h.useState({denominazione:i.denominazione,idFiscaleIVAPaese:i.idFiscaleIVAPaese,idFiscaleIVACodice:i.idFiscaleIVACodice,codiceFiscale:i.codiceFiscale}),[m,E]=h.useState({denominazione:!1,idFiscaleIVAPaese:!1,idFiscaleIVACodice:!1,codiceFiscale:!1});h.useEffect(()=>{t(_(o.idFiscaleIVAPaese,o.idFiscaleIVACodice))},[o]);const v=d=>{const{name:a,value:n}=d.target;q({...o,[a]:n}),E({...m,[a]:n.toString().length<1}),a==="idFiscaleIVAPaese"&&E({...m,idFiscaleIVAPaese:n.toString().length!=2})},[p,D]=h.useState({indirizzo:(S=i.sede)==null?void 0:S.indirizzo,numeroCivico:(b=i.sede)==null?void 0:b.numeroCivico,cap:(V=i.sede)==null?void 0:V.cap,comune:(x=i.sede)==null?void 0:x.comune,provincia:(P=i.sede)==null?void 0:P.provincia,nazione:(y=i.sede)==null?void 0:y.nazione}),[r,g]=h.useState({indirizzo:!1,numeroCivico:!1,cap:!1,comune:!1,provincia:!1,nazione:!1}),z=d=>{const{name:a,value:n,required:k}=d.target;D({...p,[a]:n}),g({...r,[a]:k&&n.toString().length<1}),a==="cap"&&g({...r,cap:n.toString().length!==5}),a==="provincia"&&g({...r,provincia:n.toString().length>0?n.toString().length!==2:!1}),a==="nazione"&&g({...r,nazione:n.toString().length!==2})},[B,O]=h.useState(!0);h.useEffect(()=>{const d=!Object.values(m).every(n=>n===!1),a=!Object.values(r).every(n=>n===!1);O(d||a)},[m,r]);const R=()=>{var a;const d={...o,sede:{id:(a=i.sede)==null?void 0:a.id,...p}};t(ne(i.id,d)),setTimeout(()=>{t(H()),f("/aziende")},1e3)};return W(M,{children:[e(F,{mb:3,children:e(ee,{variant:"h3",children:"Aggiungi Azienda"})}),e(F,{mb:3,children:e(ie,{children:e(F,{p:2,children:W(s,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e(s,{item:!0,xs:12,children:e(l,{label:"Denominazione o Nome e Cognome",name:"denominazione",value:o.denominazione,error:m.denominazione,fullWidth:!0,onChange:v})}),e(s,{item:!0,xs:2,children:e(l,{label:"Nazione",name:"idFiscaleIVAPaese",value:o.idFiscaleIVAPaese,error:m.idFiscaleIVAPaese,fullWidth:!0,onChange:v})}),e(s,{item:!0,xs:10,children:e(l,{label:"Partita IVA",name:"idFiscaleIVACodice",value:o.idFiscaleIVACodice,error:m.idFiscaleIVACodice,fullWidth:!0,onChange:v})}),e(s,{item:!0,xs:12,children:o.idFiscaleIVAPaese!==i.idFiscaleIVAPaese&&o.idFiscaleIVACodice!==i.idFiscaleIVACodice&&e(T,{severity:c?"error":"success",children:c?"Azienda giÃ  esistente!":"Azienda disponibile"})}),e(s,{item:!0,xs:12,children:e(l,{label:"Codice Fiscale",name:"codiceFiscale",value:o.codiceFiscale,error:m.codiceFiscale,fullWidth:!0,onChange:v})}),e(s,{item:!0,xs:10,children:e(l,{fullWidth:!0,label:"Indirizzo",name:"indirizzo",value:p.indirizzo,error:r.indirizzo,required:!0,onChange:z})}),e(s,{item:!0,xs:2,children:e(l,{fullWidth:!0,label:"N. Civico",name:"numeroCivico",value:p.numeroCivico,error:r.numeroCivico,onChange:z})}),e(s,{item:!0,xs:12,sm:6,children:e(l,{fullWidth:!0,label:"CAP",name:"cap",value:p.cap,error:r.cap,required:!0,onChange:z})}),e(s,{item:!0,xs:12,sm:6,children:e(l,{fullWidth:!0,label:"Comune",name:"comune",value:p.comune,error:r.comune,required:!0,onChange:z})}),e(s,{item:!0,xs:12,sm:6,children:e(l,{fullWidth:!0,label:"Provincia",name:"provincia",value:p.provincia,error:r.provincia,onChange:z,helperText:"Esempio: BS"})}),e(s,{item:!0,xs:12,sm:6,children:e(l,{fullWidth:!0,label:"Nazione",name:"nazione",value:p.nazione,error:r.nazione,onChange:z,required:!0,helperText:"Esempio: IT"})})]})})})}),e(ae,{open:!A.isEmpty(I),children:e(T,{severity:C?"error":"info",children:I})}),e(Z,{onClick:R,disabled:c||B,loading:u})]})},he=()=>{const i=j(),{id:f}=J(),{dettagli:t,getting:c,getError:u}=N(C=>C.aziende);return h.useEffect(()=>{A.isEmpty(f)||i(U(f))},[]),c?e(L,{}):!A.isEmpty(u)||A.isEmpty(t)?e(Q,{message:u||"Errore di caricamento"}):e(re,{dettagli:t})};export{he as default};
