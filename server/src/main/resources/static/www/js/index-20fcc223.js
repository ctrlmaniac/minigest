import{r as U,_ as k,q as Y,d as ee,a as t,M as j,N as _,Q as ne,S as re,U as te,V as ie,W as Z,R as h,j as S,F as ae,X as se}from"./index-93a658e1.js";import{c as oe,a as q,E as L,u as ce,b as Q,T as f}from"./index-662e9df6.js";import{g as le,a as ue,s as de,e as pe,c as me,b as ge,B as $}from"./Box-eb43530e.js";import{P as T}from"./Paper-7dd117f4.js";import{T as G}from"./Typography-85a707cf.js";import{A as X}from"./Alert-6978e496.js";import"./ButtonBase-4f0918eb.js";const fe=U.createContext(),H=fe;function he(e){return le("MuiGrid",e)}const xe=[0,1,2,3,4,5,6,7,8,9,10],ve=["column-reverse","column","row-reverse","row"],we=["nowrap","wrap-reverse","wrap"],I=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],V=ue("MuiGrid",["root","container","item","zeroMinWidth",...xe.map(e=>`spacing-xs-${e}`),...ve.map(e=>`direction-xs-${e}`),...we.map(e=>`wrap-xs-${e}`),...I.map(e=>`grid-xs-${e}`),...I.map(e=>`grid-sm-${e}`),...I.map(e=>`grid-md-${e}`),...I.map(e=>`grid-lg-${e}`),...I.map(e=>`grid-xl-${e}`)]),Ce=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function y(e){const r=parseFloat(e);return`${r}${String(e).replace(String(r),"")||"px"}`}function be({theme:e,ownerState:r}){let i;return e.breakpoints.keys.reduce((n,s)=>{let a={};if(r[s]&&(i=r[s]),!i)return n;if(i===!0)a={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(i==="auto")a={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const d=j({values:r.columns,breakpoints:e.breakpoints.values}),u=typeof d=="object"?d[s]:d;if(u==null)return n;const c=`${Math.round(i/u*1e8)/1e6}%`;let m={};if(r.container&&r.item&&r.columnSpacing!==0){const o=e.spacing(r.columnSpacing);if(o!=="0px"){const v=`calc(${c} + ${y(o)})`;m={flexBasis:v,maxWidth:v}}}a=k({flexBasis:c,flexGrow:0,maxWidth:c},m)}return e.breakpoints.values[s]===0?Object.assign(n,a):n[e.breakpoints.up(s)]=a,n},{})}function ze({theme:e,ownerState:r}){const i=j({values:r.direction,breakpoints:e.breakpoints.values});return _({theme:e},i,n=>{const s={flexDirection:n};return n.indexOf("column")===0&&(s[`& > .${V.item}`]={maxWidth:"none"}),s})}function J({breakpoints:e,values:r}){let i="";Object.keys(r).forEach(s=>{i===""&&r[s]!==0&&(i=s)});const n=Object.keys(e).sort((s,a)=>e[s]-e[a]);return n.slice(0,n.indexOf(i))}function Se({theme:e,ownerState:r}){const{container:i,rowSpacing:n}=r;let s={};if(i&&n!==0){const a=j({values:n,breakpoints:e.breakpoints.values});let d;typeof a=="object"&&(d=J({breakpoints:e.breakpoints.values,values:a})),s=_({theme:e},a,(u,c)=>{var m;const o=e.spacing(u);return o!=="0px"?{marginTop:`-${y(o)}`,[`& > .${V.item}`]:{paddingTop:y(o)}}:(m=d)!=null&&m.includes(c)?{}:{marginTop:0,[`& > .${V.item}`]:{paddingTop:0}}})}return s}function $e({theme:e,ownerState:r}){const{container:i,columnSpacing:n}=r;let s={};if(i&&n!==0){const a=j({values:n,breakpoints:e.breakpoints.values});let d;typeof a=="object"&&(d=J({breakpoints:e.breakpoints.values,values:a})),s=_({theme:e},a,(u,c)=>{var m;const o=e.spacing(u);return o!=="0px"?{width:`calc(100% + ${y(o)})`,marginLeft:`-${y(o)}`,[`& > .${V.item}`]:{paddingLeft:y(o)}}:(m=d)!=null&&m.includes(c)?{}:{width:"100%",marginLeft:0,[`& > .${V.item}`]:{paddingLeft:0}}})}return s}function Ae(e,r,i={}){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[i[`spacing-xs-${String(e)}`]];const n=[];return r.forEach(s=>{const a=e[s];Number(a)>0&&n.push(i[`spacing-${s}-${String(a)}`])}),n}const We=de("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:i}=e,{container:n,direction:s,item:a,spacing:d,wrap:u,zeroMinWidth:c,breakpoints:m}=i;let o=[];n&&(o=Ae(d,m,r));const v=[];return m.forEach(x=>{const g=i[x];g&&v.push(r[`grid-${x}-${String(g)}`])}),[r.root,n&&r.container,a&&r.item,c&&r.zeroMinWidth,...o,s!=="row"&&r[`direction-xs-${String(s)}`],u!=="wrap"&&r[`wrap-xs-${String(u)}`],...v]}})(({ownerState:e})=>k({boxSizing:"border-box"},e.container&&{display:"flex",flexWrap:"wrap",width:"100%"},e.item&&{margin:0},e.zeroMinWidth&&{minWidth:0},e.wrap!=="wrap"&&{flexWrap:e.wrap}),ze,Se,$e,be);function ye(e,r){if(!e||e<=0)return[];if(typeof e=="string"&&!Number.isNaN(Number(e))||typeof e=="number")return[`spacing-xs-${String(e)}`];const i=[];return r.forEach(n=>{const s=e[n];if(Number(s)>0){const a=`spacing-${n}-${String(s)}`;i.push(a)}}),i}const Ee=e=>{const{classes:r,container:i,direction:n,item:s,spacing:a,wrap:d,zeroMinWidth:u,breakpoints:c}=e;let m=[];i&&(m=ye(a,c));const o=[];c.forEach(x=>{const g=e[x];g&&o.push(`grid-${x}-${String(g)}`)});const v={root:["root",i&&"container",s&&"item",u&&"zeroMinWidth",...m,n!=="row"&&`direction-xs-${String(n)}`,d!=="wrap"&&`wrap-xs-${String(d)}`,...o]};return ge(v,he,r)},Ne=U.forwardRef(function(r,i){const n=Y({props:r,name:"MuiGrid"}),{breakpoints:s}=oe(),a=pe(n),{className:d,columns:u,columnSpacing:c,component:m="div",container:o=!1,direction:v="row",item:x=!1,rowSpacing:g,spacing:E=0,wrap:w="wrap",zeroMinWidth:O=!1}=a,C=ee(a,Ce),N=g||E,M=c||E,W=U.useContext(H),F=o?u||12:W,P={},R=k({},C);s.keys.forEach(l=>{C[l]!=null&&(P[l]=C[l],delete R[l])});const B=k({},a,{columns:F,container:o,direction:v,item:x,rowSpacing:N,columnSpacing:M,wrap:w,zeroMinWidth:O,spacing:E},P,{breakpoints:s.keys}),D=Ee(B);return t(H.Provider,{value:F,children:t(We,k({ownerState:B,className:me(D.root,d),as:m,ref:i},R))})}),p=Ne;function Ie(e){return async r=>{r(ne()),q.post(L.ACCOUNT,e).then(i=>{r(re()),window.location.href="/app"}).catch(i=>{let n="errore";i.response?n=i.response.data:n=i.message,r(te(n))})}}function ke(e,r){return async i=>{q.get(`${L.AZIENDE}/esiste?paese=${e}&codice=${r}`).then(n=>{n.data,i(ie(n.data))})}}function Ve(e){return async r=>{q.get(`${L.ACCOUNT}/esiste?email=${e}`).then(i=>{r(Z(i.data))}).catch(i=>{let n=!1;i.response?n=i.response.data:n=!1,r(Z(n))})}}const Oe=()=>{const e=ce(),{esiste:r}=Q(l=>l.aziende),{exists:i}=Q(l=>l.account),[n,s]=h.useState({fname:"",lname:"",email:"",password:"",passwordRepeat:""}),[a,d]=h.useState({fname:!0,lname:!0,email:!0,password:!0,passwordRepeat:!0}),u=l=>{const{name:b,value:z}=l.target;s({...n,[b]:z}),d({...a,[b]:z.toString().length<1})};h.useEffect(()=>{d({...a,password:n.password!==n.passwordRepeat||n.password.toString().length<1,passwordRepeat:n.password!==n.passwordRepeat||n.passwordRepeat.toString().length<1})},[n]);const[c,m]=h.useState({denominazione:"",idFiscaleIVAPaese:"IT",idFiscaleIVACodice:"",codiceFiscale:""}),[o,v]=h.useState({denominazione:!0,idFiscaleIVAPaese:!1,idFiscaleIVACodice:!0,codiceFiscale:!0}),x=l=>{const{name:b,value:z}=l.target;m({...c,[b]:z}),v({...o,[b]:z.toString().length<1})};h.useEffect(()=>{e(ke(c.idFiscaleIVAPaese,c.idFiscaleIVACodice))},[c]),h.useEffect(()=>{e(Ve(n.email))},[n]);const[g,E]=h.useState({indirizzo:"",numeroCivico:"",cap:"",comune:"",provincia:"",nazione:"IT"}),[w,O]=h.useState({indirizzo:!0,numeroCivico:!1,cap:!0,comune:!0,provincia:!1,nazione:!1}),C=l=>{const{name:b,value:z,required:K}=l.target;E({...g,[b]:z}),K&&O({...w,[b]:z.toString().length<1})},[N,M]=h.useState({nome:""}),[W,F]=h.useState({nome:!0}),P=l=>{M({...N,nome:l.target.value}),F({...W,nome:l.target.value.toString().length<1})},[R,B]=h.useState(!0);h.useEffect(()=>{const l=!Object.values(a).every(A=>A===!1),b=!Object.values(o).every(A=>A===!1),z=!Object.values(w).every(A=>A===!1),K=!Object.values(W).every(A=>A===!1);B(l||b||z||K)},[a,o,w,W]);const D=()=>{const l={account:{fname:n.fname,lname:n.lname,email:n.email,password:n.password},azienda:c,sede:g,negozio:{...N}};e(Ie(l))};return S(ae,{children:[t($,{mb:3,children:t(T,{children:S($,{p:2,children:[t(G,{variant:"h6",gutterBottom:!0,children:"Dati personali"}),S(p,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[t(p,{item:!0,xs:12,sm:6,children:t(f,{label:"Nome",name:"fname",value:n.fname,error:a.fname,fullWidth:!0,onChange:u})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{label:"Cognome",name:"lname",value:n.lname,error:a.lname,fullWidth:!0,onChange:u})}),S(p,{item:!0,xs:12,children:[t(f,{label:"Email",name:"email",value:n.email,error:a.email,fullWidth:!0,onChange:u,type:"email"}),t(X,{severity:i?"error":"success",sx:{marginTop:2},children:i?"Email già registrata":"Email disponibile"})]}),t(p,{item:!0,xs:12,sm:6,children:t(f,{label:"Password",name:"password",value:n.password,error:a.password,fullWidth:!0,onChange:u,type:"password",helperText:a.password?"le password devono coincidere":""})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{label:"Ripeti password",name:"passwordRepeat",value:n.passwordRepeat,error:a.passwordRepeat,fullWidth:!0,onChange:u,type:"password",helperText:a.passwordRepeat?"le password devono coincidere":""})})]})]})})}),t($,{mb:3,children:t(T,{children:S($,{p:2,children:[t(G,{variant:"h6",gutterBottom:!0,children:"Aggiungi la tua azienda"}),S(p,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[t(p,{item:!0,xs:12,children:t(f,{label:"Denominazione o Nome e Cognome",name:"denominazione",value:c.denominazione,error:o.denominazione,fullWidth:!0,onChange:x})}),t(p,{item:!0,xs:2,children:t(f,{label:"Nazione",name:"idFiscaleIVAPaese",value:c.idFiscaleIVAPaese,error:o.idFiscaleIVAPaese,fullWidth:!0,onChange:x})}),t(p,{item:!0,xs:10,children:t(f,{label:"Partita IVA",name:"idFiscaleIVACodice",value:c.idFiscaleIVACodice,error:o.idFiscaleIVACodice,fullWidth:!0,onChange:x})}),t(p,{item:!0,xs:12,children:t(X,{severity:r?"error":"success",children:r?"Azienda già presente":"Azienda disponibile per essere registrata"})}),t(p,{item:!0,xs:12,children:t(f,{label:"Codice Fiscale",name:"codiceFiscale",value:c.codiceFiscale,error:o.codiceFiscale,fullWidth:!0,onChange:x})})]})]})})}),t($,{mb:3,children:t(T,{children:S($,{p:2,children:[t(G,{gutterBottom:!0,variant:"h6",children:"Aggiungi la sede della tua azienda"}),S(p,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[t(p,{item:!0,xs:10,children:t(f,{fullWidth:!0,label:"Indirizzo",name:"indirizzo",value:g.indirizzo,error:w.indirizzo,required:!0,onChange:C})}),t(p,{item:!0,xs:2,children:t(f,{fullWidth:!0,label:"N. Civico",name:"numeroCivico",value:g.numeroCivico,error:w.numeroCivico,onChange:C})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{fullWidth:!0,label:"CAP",name:"cap",value:g.cap,error:w.cap,required:!0,onChange:C})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{fullWidth:!0,label:"Comune",name:"comune",value:g.comune,error:w.comune,required:!0,onChange:C})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{fullWidth:!0,label:"Provincia",name:"provincia",value:g.provincia,error:w.provincia,onChange:C,helperText:"Esempio: BS"})}),t(p,{item:!0,xs:12,sm:6,children:t(f,{fullWidth:!0,label:"Nazione",name:"nazione",value:g.nazione,error:w.nazione,onChange:C,required:!0,helperText:"Esempio: IT"})})]})]})})}),t($,{mb:16,children:t(T,{children:S($,{p:2,children:[t(G,{gutterBottom:!0,variant:"h6",children:"Aggiungi il nome del tuo negozio"}),t(f,{fullWidth:!0,label:"Nome Negozio",name:"nome",value:N.nome,error:W.nome,onChange:P})]})})}),t(se,{handleClick:D,disabled:R||r||i})]})};export{Oe as default};
