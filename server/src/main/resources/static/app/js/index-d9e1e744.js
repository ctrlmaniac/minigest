import{R as l,j as e,F as O,b as i,aG as te,aH as ne,l as I,ak as ae,o as re}from"./index-222da0ba.js";import{l as ie}from"./list-ae7dc43c.js";import{A as P,l as oe}from"./list-d1945695.js";import{u as H,B as m,T as F,a as $}from"./hooks-db4dee7a.js";import{a as V,b as L}from"./DialogContent-d1142615.js";import{T as f}from"./TextField-9f2cfd53.js";import{D as G}from"./DialogActions-6a8a3d75.js";import{B as E}from"./Button-30f411bc.js";import{a as le,E as se}from"./index-c44c1a12.js";import{P as A}from"./Paper-96727556.js";import{G as d}from"./Grid-c9b8ca58.js";import{A as W}from"./Alert-6c557f0c.js";import{T as j,a as y,b as o,c as k}from"./TableRow-00ec436f.js";import{T as R}from"./TableHead-137e9606.js";import{I as T}from"./IconTrash-628b6ddf.js";import{I as B}from"./IconButton-8b5a614b.js";import"./Popper-a9fe7db2.js";import"./utils-50920ebd.js";import"./TransitionGroupContext-58f02f0d.js";import"./ListSubheader-69d8aba0.js";import"./Grow-dd1bfbaf.js";import"./useTheme-88693805.js";import"./createSvgIcon-208d5829.js";import"./ButtonBase-f82ec6e5.js";import"./Modal-821d5a1c.js";import"./List-670810c7.js";import"./createReactComponent-d2644421.js";const ce=({open:p,handleClose:c,onSubmit:u})=>{const[t,s]=l.useState({aliquota:22,imponibile:0,imposta:0}),[r,h]=l.useState({aliquota:!1,imponibile:!1,imposta:!1}),[z,v]=l.useState(!0);l.useEffect(()=>{v(!Object.values(r).every(g=>g===!1))},[r]);const b=g=>{const{value:S,name:C,required:x}=g.target;s({...t,[C]:S}),x&&h({...r,[C]:S.toString().length<1})},D=()=>{c(!1),u(t)};return e(O,{children:i(V,{open:p,onClose:()=>c(!1),children:[i(L,{children:[e(f,{fullWidth:!0,label:"Aliquota IVA",name:"aliquota",margin:"normal",value:t.aliquota,error:r.aliquota,onChange:b}),e(f,{fullWidth:!0,label:"Imponibile",name:"imponibile",margin:"normal",value:t.imponibile,error:r.imponibile,onChange:b}),e(f,{fullWidth:!0,label:"Imposta",name:"imposta",margin:"normal",value:t.imposta,error:r.imposta,onChange:b})]}),e(G,{children:e(E,{disabled:z,onClick:D,children:"salva"})})]})})};function de(p){return async c=>{le.post(`${se.FATTURE}`,p).then(u=>{c(te(u.data)),window.location.href=`/app/docfisc/fatture/dettagli/${u.data.id}`}).catch(u=>{c(ne(u.message))})}}const me=({open:p,handleClose:c,onSubmit:u})=>{const[t,s]=l.useState({data:new Date().toISOString().split("T")[0],importo:0}),[r,h]=l.useState({data:!1,importo:!1}),[z,v]=l.useState(!0);l.useEffect(()=>{v(!Object.values(r).every(g=>g===!1))},[r]);const b=g=>{const{value:S,name:C,required:x}=g.target;s({...t,[C]:S}),x&&h({...r,[C]:S.toString().length<1})},D=()=>{c(!1),u(t)};return e(O,{children:i(V,{open:p,onClose:()=>c(!1),children:[i(L,{children:[e(f,{fullWidth:!0,label:"Data Scadenza",name:"data",margin:"normal",value:t.data,error:r.data,onChange:b,type:"date"}),e(f,{fullWidth:!0,label:"Importo",name:"importo",margin:"normal",value:t.importo,error:r.importo,onChange:b})]}),e(G,{children:e(E,{disabled:z,onClick:D,children:"salva"})})]})})},ue=({open:p,handleClose:c,onSubmit:u})=>{const[t,s]=l.useState({data:new Date().toISOString().split("T")[0],importo:0}),[r,h]=l.useState({data:!1,importo:!1}),[z,v]=l.useState(!0);l.useEffect(()=>{v(!Object.values(r).every(g=>g===!1))},[r]);const b=g=>{const{value:S,name:C,required:x}=g.target;s({...t,[C]:S}),x&&h({...r,[C]:S.toString().length<1})},D=()=>{c(!1),u(t)};return e(O,{children:i(V,{open:p,onClose:()=>c(!1),children:[i(L,{children:[e(f,{fullWidth:!0,label:"Data Pagamento",name:"data",margin:"normal",value:t.data,error:r.data,onChange:b,type:"date"}),e(f,{fullWidth:!0,label:"Importo",name:"importo",margin:"normal",value:t.importo,error:r.importo,onChange:b})]}),e(G,{children:e(E,{disabled:z,onClick:D,children:"salva"})})]})})},he=({tipiDocumento:p,aziende:c})=>{const u=H(),[t,s]=l.useState({cedente:null,committente:null,tipoDocumento:I.find(p,["descrizione","fattura"])||null,data:new Date().toISOString().split("T")[0],numero:"",totale:0,reparti:[],scadenze:[],pagamenti:[]}),[r,h]=l.useState({cedente:!0,committente:!0,tipoDocumento:!1,data:!1,numero:!0,totale:!1,reparti:!0,scadenze:!0,pagamenti:!1}),[z,v]=l.useState(!1),[b,D]=l.useState(!1),[g,S]=l.useState(!1),[C,x]=l.useState(!0);l.useEffect(()=>{x(!Object.values(r).every(n=>n===!1))},[r]);const N=(n,a,q)=>{s({...t,cedente:a}),h({...r,cedente:I.isEmpty(a)})},Q=(n,a,q)=>{s({...t,committente:a}),h({...r,committente:I.isEmpty(a)})},U=(n,a,q)=>{s({...t,tipoDocumento:a}),h({...r,tipoDocumento:I.isEmpty(a)})},w=n=>{const{value:a,name:q,required:ee}=n.target;s({...t,[q]:a}),ee&&h({...r,[q]:a.length<1})},J=n=>{const a=[...t.reparti,n];s({...t,reparti:a}),h({...r,reparti:a.length<1})},K=n=>{const a=[...t.reparti];a.splice(n,1),s({...t,reparti:a}),h({...r,reparti:a.length<1})},M=n=>{const a=[...t.scadenze,n];s({...t,scadenze:a}),h({...r,scadenze:a.length<1})},X=n=>{const a=[...t.scadenze];a.splice(n,1),s({...t,scadenze:a}),h({...r,scadenze:a.length<1})},Y=n=>{const a=[...t.pagamenti,n];s({...t,pagamenti:a})},Z=n=>{const a=[...t.pagamenti];a.splice(n,1),s({...t,pagamenti:a})},_=()=>{const n={cedente:t.cedente,committente:t.committente,tipoDocumento:t.tipoDocumento,data:t.data,numero:t.numero,totale:t.totale,reparti:t.reparti,scadenze:t.scadenze,pagamenti:t.pagamenti};u(de(n))};return i(O,{children:[e(m,{mb:3,children:e(F,{variant:"h3",children:"Aggiungi Fattura"})}),e(m,{mb:3,children:e(A,{children:e(m,{p:2,children:i(d,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",spacing:2,children:[e(d,{item:!0,xs:12,children:e(P,{fullWidth:!0,disablePortal:!0,options:p,getOptionLabel:n=>n.descrizione,value:t.tipoDocumento,isOptionEqualToValue:(n,a)=>n.descrizione===a.descrizione,onChange:U,renderInput:n=>e(f,{...n,label:"Tipo Doc. Fisc.",name:"tipoDocumento",required:!0,error:r.tipoDocumento})})}),e(d,{item:!0,xs:12,sm:6,children:e(P,{fullWidth:!0,disablePortal:!0,options:c,getOptionLabel:n=>n.denominazione,value:t.cedente,isOptionEqualToValue:(n,a)=>n.denominazione===a.denominazione,onChange:N,renderInput:n=>e(f,{...n,label:"Cedente",name:"cedente",required:!0,error:r.cedente})})}),e(d,{item:!0,xs:12,sm:6,children:e(P,{fullWidth:!0,disablePortal:!0,options:c,getOptionLabel:n=>n.denominazione,value:t.committente,isOptionEqualToValue:(n,a)=>n.denominazione===a.denominazione,onChange:Q,renderInput:n=>e(f,{...n,label:"Committente",name:"committente",required:!0,error:r.committente})})}),e(d,{item:!0,xs:12,sm:6,children:e(f,{fullWidth:!0,label:"Data",name:"data",value:t.data,error:r.data,onChange:w,type:"date",required:!0})}),e(d,{item:!0,xs:12,sm:6,children:e(f,{fullWidth:!0,label:"Numero",name:"numero",value:t.numero,error:r.numero,onChange:w,required:!0})}),e(d,{item:!0,xs:12,children:e(f,{fullWidth:!0,label:"Totale documento",name:"totale",value:t.totale,error:r.totale,onChange:w,type:"number",inputProps:{step:.01},required:!0})})]})})})}),e(m,{mb:3,children:e(A,{children:i(m,{p:2,children:[i(d,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(d,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Reparti"})}),e(d,{item:!0,xs:6,children:e(m,{sx:{textAlign:"right"},children:e(E,{onClick:()=>v(!0),children:"aggiungi"})})})]}),e(m,{mt:2,children:I.isEmpty(t.reparti)?e(W,{severity:"error",children:"Devi aggiungere almeno un reparto!"}):i(j,{children:[e(R,{children:i(y,{children:[e(o,{children:"Aliquota"}),e(o,{children:"Imponibile"}),e(o,{children:"Imposta"}),e(o,{sx:{width:50},align:"center",children:e(T,{})})]})}),e(k,{children:t.reparti.map((n,a)=>i(y,{children:[i(o,{children:["% ",n.aliquota]}),i(o,{children:["€ ",n.imponibile]}),i(o,{children:["€ ",n.imposta]}),e(o,{children:e(B,{color:"error",onClick:()=>K(a),children:e(T,{})})})]},a))})]})})]})})}),e(m,{mb:3,children:e(A,{children:i(m,{p:2,children:[i(d,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(d,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Scadenze"})}),e(d,{item:!0,xs:6,children:e(m,{sx:{textAlign:"right"},children:e(E,{onClick:()=>D(!0),children:"aggiungi"})})})]}),e(m,{mt:2,children:I.isEmpty(t.scadenze)?e(W,{severity:"error",children:"Devi aggiungere almeno una scadenza!"}):i(j,{children:[e(R,{children:i(y,{children:[e(o,{children:"Data"}),e(o,{children:"Importo"}),e(o,{sx:{width:50},align:"center",children:e(T,{})})]})}),e(k,{children:t.scadenze.map((n,a)=>i(y,{children:[e(o,{children:n.data}),i(o,{children:["€ ",n.importo]}),e(o,{children:e(B,{color:"error",onClick:()=>X(a),children:e(T,{})})})]},a))})]})})]})})}),e(m,{children:e(A,{children:i(m,{p:2,children:[i(d,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(d,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Pagamenti"})}),e(d,{item:!0,xs:6,children:e(m,{sx:{textAlign:"right"},children:e(E,{onClick:()=>S(!0),children:"aggiungi"})})})]}),e(m,{mt:2,children:I.isEmpty(t.pagamenti)?e(W,{severity:"warning",children:"Questa fattura non ha pagamenti registrati"}):i(j,{children:[e(R,{children:i(y,{children:[e(o,{children:"Data"}),e(o,{children:"Importo"}),e(o,{sx:{width:50},align:"center",children:e(T,{})})]})}),e(k,{children:t.pagamenti.map((n,a)=>i(y,{children:[e(o,{children:n.data}),i(o,{children:["€ ",n.importo]}),e(o,{children:e(B,{color:"error",onClick:()=>Z(a),children:e(T,{})})})]},a))})]})})]})})}),e(ce,{open:z,handleClose:v,onSubmit:J}),e(me,{open:b,handleClose:D,onSubmit:M}),e(ue,{open:g,handleClose:S,onSubmit:Y}),e(ae,{disabled:C,handleClick:_})]})},Ge=()=>{const p=H(),{list:c,listing:u}=$(r=>r.aziende),{list:t,listing:s}=$(r=>r.tipiDocFisc);return l.useEffect(()=>{p(ie()),p(oe())},[]),u||s?e(re,{}):e(he,{aziende:c,tipiDocumento:t})};export{Ge as default};
