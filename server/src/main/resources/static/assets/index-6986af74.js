import{R as d,j as e,F as O,a as i,aX as ne,aY as re,B as g,V as x,ac as ae,Z as ie}from"./index-7862eb00.js";import{E as oe}from"./ErrorScreen-eca8d1bc.js";import{l as le}from"./list-ba9b3091.js";import{l as se}from"./list-78acd7a5.js";import{u as N,a as w}from"./hooks-d3ca2a4c.js";import{S as ce}from"./SaveFab-d7db3c27.js";import{a as L,b as $}from"./DialogContent-c118acd9.js";import{T as S}from"./TextField-1bd45967.js";import{D as G}from"./DialogActions-dd2f205a.js";import{B as T}from"./Button-dde57f38.js";import{a as me,E as de}from"./index-30e337fd.js";import{T as F}from"./Typography-a27d4a59.js";import{P as A}from"./Paper-7dd8998f.js";import{G as h}from"./Grid-242ecbb1.js";import{A as W}from"./Autocomplete-08eeefbd.js";import{A as j,I as k}from"./Alert-5fa013c6.js";import{T as R,a as I,b as m,c as B}from"./TableRow-ee613352.js";import{T as V}from"./TableHead-a97793ca.js";import{I as y}from"./IconTrash-67afca16.js";import{g as ue}from"./get-ec787158.js";import"./Container-ae15322d.js";import"./Fab-7f11b1aa.js";import"./ButtonBase-52577508.js";import"./createReactComponent-ec120697.js";import"./useTheme-eae15486.js";import"./Modal-d6c190e6.js";import"./utils-682c87a5.js";import"./Grow-c742a7e6.js";import"./List-1ac29d19.js";import"./createSvgIcon-8230f01b.js";import"./Popper-c07b6784.js";import"./ListSubheader-1b3fd3b3.js";const pe=({open:b,handleClose:u,onSubmit:s})=>{const[o,n]=d.useState({aliquota:22,imponibile:0,imposta:0}),[a,l]=d.useState({aliquota:!1,imponibile:!1,imposta:!1}),[p,D]=d.useState(!0);d.useEffect(()=>{D(!Object.values(a).every(c=>c===!1))},[a]);const f=c=>{const{value:v,name:C,required:E}=c.target;n({...o,[C]:v}),E&&l({...a,[C]:v.toString().length<1})},z=()=>{u(!1),s(o)};return e(O,{children:i(L,{open:b,onClose:()=>u(!1),children:[i($,{children:[e(S,{fullWidth:!0,label:"Aliquota IVA",name:"aliquota",margin:"normal",value:o.aliquota,error:a.aliquota,onChange:f}),e(S,{fullWidth:!0,label:"Imponibile",name:"imponibile",margin:"normal",value:o.imponibile,error:a.imponibile,onChange:f}),e(S,{fullWidth:!0,label:"Imposta",name:"imposta",margin:"normal",value:o.imposta,error:a.imposta,onChange:f})]}),e(G,{children:e(T,{disabled:p,onClick:z,children:"salva"})})]})})};function he(b,u){return async s=>{me.put(`${de.FATTURE}/${b}`,u).then(o=>{s(ne(o.data)),window.location.href=`/app/docfisc/fatture/dettagli/${o.data.id}`}).catch(o=>{s(re(o.message))})}}const ge=({open:b,handleClose:u,onSubmit:s})=>{const[o,n]=d.useState({data:new Date().toISOString().split("T")[0],importo:0}),[a,l]=d.useState({data:!1,importo:!1}),[p,D]=d.useState(!0);d.useEffect(()=>{D(!Object.values(a).every(c=>c===!1))},[a]);const f=c=>{const{value:v,name:C,required:E}=c.target;n({...o,[C]:v}),E&&l({...a,[C]:v.toString().length<1})},z=()=>{u(!1),s(o)};return e(O,{children:i(L,{open:b,onClose:()=>u(!1),children:[i($,{children:[e(S,{fullWidth:!0,label:"Data Scadenza",name:"data",margin:"normal",value:o.data,error:a.data,onChange:f,type:"date"}),e(S,{fullWidth:!0,label:"Importo",name:"importo",margin:"normal",value:o.importo,error:a.importo,onChange:f})]}),e(G,{children:e(T,{disabled:p,onClick:z,children:"salva"})})]})})},fe=({open:b,handleClose:u,onSubmit:s})=>{const[o,n]=d.useState({data:new Date().toISOString().split("T")[0],importo:0}),[a,l]=d.useState({data:!1,importo:!1}),[p,D]=d.useState(!0);d.useEffect(()=>{D(!Object.values(a).every(c=>c===!1))},[a]);const f=c=>{const{value:v,name:C,required:E}=c.target;n({...o,[C]:v}),E&&l({...a,[C]:v.toString().length<1})},z=()=>{u(!1),s(o)};return e(O,{children:i(L,{open:b,onClose:()=>u(!1),children:[i($,{children:[e(S,{fullWidth:!0,label:"Data Pagamento",name:"data",margin:"normal",value:o.data,error:a.data,onChange:f,type:"date"}),e(S,{fullWidth:!0,label:"Importo",name:"importo",margin:"normal",value:o.importo,error:a.importo,onChange:f})]}),e(G,{children:e(T,{disabled:p,onClick:z,children:"salva"})})]})})},be=({tipiDocumento:b,aziende:u,dettagli:s})=>{const o=N(),[n,a]=d.useState({cedente:s.cedente,committente:s.committente,tipoDocumento:s.tipoDocumento,data:s.data,numero:s.numero,totale:s.totale,reparti:s.reparti,scadenze:s.scadenze,pagamenti:s.pagamenti}),[l,p]=d.useState({cedente:!1,committente:!1,tipoDocumento:!1,data:!1,numero:!1,totale:!1,reparti:!1,scadenze:!1,pagamenti:!1}),[D,f]=d.useState(!1),[z,c]=d.useState(!1),[v,C]=d.useState(!1),[E,H]=d.useState(!0);d.useEffect(()=>{H(!Object.values(l).every(t=>t===!1))},[l]);const M=(t,r,q)=>{a({...n,cedente:r}),p({...l,cedente:x.isEmpty(r)})},U=(t,r,q)=>{a({...n,committente:r}),p({...l,committente:x.isEmpty(r)})},X=(t,r,q)=>{a({...n,tipoDocumento:r}),p({...l,tipoDocumento:x.isEmpty(r)})},P=t=>{const{value:r,name:q,required:te}=t.target;a({...n,[q]:r}),te&&p({...l,[q]:r.toString().length<1})},Y=t=>{const r=[...n.reparti,t];a({...n,reparti:r}),p({...l,reparti:r.length<1})},Z=t=>{const r=[...n.reparti];r.splice(t,1),a({...n,reparti:r}),p({...l,reparti:r.length<1})},J=t=>{const r=[...n.scadenze,t];a({...n,scadenze:r}),p({...l,scadenze:r.length<1})},K=t=>{const r=[...n.scadenze];r.splice(t,1),a({...n,scadenze:r}),p({...l,scadenze:r.length<1})},Q=t=>{const r=[...n.pagamenti,t];a({...n,pagamenti:r})},_=t=>{const r=[...n.pagamenti];r.splice(t,1),a({...n,pagamenti:r})},ee=()=>{const t={cedente:n.cedente,committente:n.committente,tipoDocumento:n.tipoDocumento,data:n.data,numero:n.numero,totale:n.totale,reparti:n.reparti,scadenze:n.scadenze,pagamenti:n.pagamenti};o(he(s.id,t))};return i(O,{children:[e(g,{mb:3,children:e(F,{variant:"h3",children:"Aggiungi Fattura"})}),e(g,{mb:3,children:e(A,{children:e(g,{p:2,children:i(h,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",spacing:2,children:[e(h,{item:!0,xs:12,children:e(W,{fullWidth:!0,disablePortal:!0,options:b,getOptionLabel:t=>t.descrizione,value:n.tipoDocumento,isOptionEqualToValue:(t,r)=>t.descrizione===r.descrizione,onChange:X,renderInput:t=>e(S,{...t,label:"Tipo Doc. Fisc.",name:"tipoDocumento",required:!0,error:l.tipoDocumento})})}),e(h,{item:!0,xs:12,sm:6,children:e(W,{fullWidth:!0,disablePortal:!0,options:u,getOptionLabel:t=>t.denominazione,value:n.cedente,isOptionEqualToValue:(t,r)=>t.denominazione===r.denominazione,onChange:M,renderInput:t=>e(S,{...t,label:"Cedente",name:"cedente",required:!0,error:l.cedente})})}),e(h,{item:!0,xs:12,sm:6,children:e(W,{fullWidth:!0,disablePortal:!0,options:u,getOptionLabel:t=>t.denominazione,value:n.committente,isOptionEqualToValue:(t,r)=>t.denominazione===r.denominazione,onChange:U,renderInput:t=>e(S,{...t,label:"Committente",name:"committente",required:!0,error:l.committente})})}),e(h,{item:!0,xs:12,sm:6,children:e(S,{fullWidth:!0,label:"Data",name:"data",value:n.data,error:l.data,onChange:P,type:"date",required:!0})}),e(h,{item:!0,xs:12,sm:6,children:e(S,{fullWidth:!0,label:"Numero",name:"numero",value:n.numero,error:l.numero,onChange:P,required:!0})}),e(h,{item:!0,xs:12,children:e(S,{fullWidth:!0,label:"Totale documento",name:"totale",value:n.totale,error:l.totale,onChange:P,type:"number",inputProps:{step:.01},required:!0})})]})})})}),e(g,{mb:3,children:e(A,{children:i(g,{p:2,children:[i(h,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(h,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Reparti"})}),e(h,{item:!0,xs:6,children:e(g,{sx:{textAlign:"right"},children:e(T,{onClick:()=>f(!0),children:"aggiungi"})})})]}),e(g,{mt:2,children:x.isEmpty(n.reparti)?e(j,{severity:"error",children:"Devi aggiungere almeno un reparto!"}):i(R,{children:[e(V,{children:i(I,{children:[e(m,{children:"Aliquota"}),e(m,{children:"Imponibile"}),e(m,{children:"Imposta"}),e(m,{sx:{width:50},align:"center",children:e(y,{})})]})}),e(B,{children:n.reparti.map((t,r)=>i(I,{children:[i(m,{children:["% ",t.aliquota]}),i(m,{children:["€ ",t.imponibile]}),i(m,{children:["€ ",t.imposta]}),e(m,{children:e(k,{color:"error",onClick:()=>Z(r),children:e(y,{})})})]},r))})]})})]})})}),e(g,{mb:3,children:e(A,{children:i(g,{p:2,children:[i(h,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(h,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Scadenze"})}),e(h,{item:!0,xs:6,children:e(g,{sx:{textAlign:"right"},children:e(T,{onClick:()=>c(!0),children:"aggiungi"})})})]}),e(g,{mt:2,children:x.isEmpty(n.scadenze)?e(j,{severity:"error",children:"Devi aggiungere almeno una scadenza!"}):i(R,{children:[e(V,{children:i(I,{children:[e(m,{children:"Data"}),e(m,{children:"Importo"}),e(m,{sx:{width:50},align:"center",children:e(y,{})})]})}),e(B,{children:n.scadenze.map((t,r)=>i(I,{children:[e(m,{children:t.data}),i(m,{children:["€ ",t.importo]}),e(m,{children:e(k,{color:"error",onClick:()=>K(r),children:e(y,{})})})]},r))})]})})]})})}),e(g,{mb:3,children:e(A,{children:i(g,{p:2,children:[i(h,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(h,{item:!0,xs:6,children:e(F,{variant:"h6",gutterBottom:!0,children:"Pagamenti"})}),e(h,{item:!0,xs:6,children:e(g,{sx:{textAlign:"right"},children:e(T,{onClick:()=>C(!0),children:"aggiungi"})})})]}),e(g,{mt:2,children:x.isEmpty(n.pagamenti)?e(j,{severity:"warning",children:"Nessun pagamento"}):i(R,{children:[e(V,{children:i(I,{children:[e(m,{children:"Data"}),e(m,{children:"Importo"}),e(m,{sx:{width:50},align:"center",children:e(y,{})})]})}),e(B,{children:n.pagamenti.map((t,r)=>i(I,{children:[e(m,{children:t.data}),i(m,{children:["€ ",t.importo]}),e(m,{children:e(k,{color:"error",onClick:()=>_(r),children:e(y,{})})})]},r))})]})})]})})}),e(pe,{open:D,handleClose:f,onSubmit:Y}),e(ge,{open:z,handleClose:c,onSubmit:J}),e(fe,{open:v,handleClose:C,onSubmit:Q}),e(ce,{disabled:E,handleClick:ee})]})},Je=()=>{const b=N(),{id:u}=ae(),{dettagli:s,getting:o,getError:n}=w(c=>c.fatture),{list:a,listing:l,listError:p}=w(c=>c.aziende),{list:D,listing:f,listError:z}=w(c=>c.tipiDocFisc);return d.useEffect(()=>{b(le()),b(se()),u&&b(ue(u))},[u]),o||l||f?e(ie,{}):n||p||z?e(oe,{message:"Errore caricamento dati"}):e(be,{dettagli:s,aziende:a,tipiDocumento:D})};export{Je as default};
