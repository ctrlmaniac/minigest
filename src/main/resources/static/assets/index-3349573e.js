import{R as l,a as o,j as e,aG as j,aH as w,F as k,N as H,a8 as z}from"./index-f45c03a1.js";import{E as G}from"./ErrorScreen-23109fc3.js";import{L}from"./LoadingScreen-7795ebdd.js";import{g as O}from"./get-d6f769d0.js";import{u as x,a as I}from"./hooks-71074923.js";import{a as $,b as N}from"./DialogContent-c6b80c7a.js";import{T as g}from"./TextField-2a8b6e79.js";import{D as U}from"./DialogActions-4298e2d3.js";import{B}from"./Button-0977364e.js";import{S as V}from"./SaveFab-bde2bcc6.js";import{a as M,E as _}from"./index-e540bbee.js";import{B as f,T as y}from"./Box-3112786e.js";import{P as A}from"./Paper-c542b63c.js";import{G as q}from"./Grid-656ee9be.js";import{A as J,I as K}from"./Alert-9ab8b305.js";import{T as Q,a as E,b as c,c as X}from"./TableRow-aa552d5a.js";import{T as Y}from"./TableHead-f12ffb5d.js";import{I as T}from"./IconTrash-34d4add2.js";import"./Splash-c0a4ca1f.js";import"./Container-b2c8bae1.js";import"./useTheme-7ac3100d.js";import"./Modal-6c34c1a4.js";import"./utils-856da27c.js";import"./ButtonBase-07c320ab.js";import"./Grow-46dd7ada.js";import"./List-cc96011b.js";import"./createSvgIcon-5f7bcaef.js";import"./Fab-8a5b0f7e.js";import"./createReactComponent-19830811.js";const Z=({open:a,handleClose:n,handleSubmit:d})=>{const[t,s]=l.useState({aliquota:22,totale:0,totaleAnnulli:0,totaleResi:0}),[i,m]=l.useState({aliquota:!1,totale:!1,totaleAnnulli:!1,totaleResi:!1}),h=v=>{const{name:C,value:S,required:F}=v.target;s({...t,[C]:S}),F&&m({...i,[C]:S.length<1})},[p,D]=l.useState(!0);l.useEffect(()=>{D(!Object.values(i).every(v=>v===!1))},[i]);const b=()=>{n(!1),d(t)};return o($,{open:a,onClose:()=>n(!1),children:[o(N,{children:[e(g,{label:"aliquota",name:"aliquota",value:t.aliquota,error:i.aliquota,fullWidth:!0,required:!0,onChange:h,margin:"normal",type:"number",inputProps:{step:.01}}),e(g,{label:"totale",name:"totale",value:t.totale,error:i.totale,fullWidth:!0,required:!0,onChange:h,margin:"normal",type:"number",inputProps:{step:.01}}),e(g,{label:"totale annulli",name:"totaleAnnulli",value:t.totaleAnnulli,error:i.totaleAnnulli,fullWidth:!0,required:!0,onChange:h,margin:"normal",type:"number",inputProps:{step:.01}}),e(g,{label:"totale resi",name:"totaleResi",value:t.totaleResi,error:i.totaleResi,fullWidth:!0,required:!0,onChange:h,margin:"normal",type:"number",inputProps:{step:.01}})]}),e(U,{children:e(B,{disabled:p,onClick:b,children:"Salva"})})]})};function ee(a,n){return async d=>{M.put(`${_.CHIUSURE_FISCALI}/${a}`,n).then(t=>{d(j(t.data)),window.location.href=`/app/docfisc/chiusure-fiscali/dettagli/${t.data.id}`}).catch(t=>{d(w(t.message))})}}const te=({dettagli:a})=>{const n=x(),[d,t]=l.useState(!1);I(r=>r.negozi);const[s,i]=l.useState({data:a.data,totale:a.totale,numeroDocFisc:a.numeroDocFisc}),[m,h]=l.useState([...a.reparti]),[p,D]=l.useState({data:!1,totale:!1,numeroDocFisc:!1}),b=r=>{const{name:u,value:R,required:W}=r.target;i({...s,[u]:R}),W&&D({...p,[u]:R.length<1})},[v,C]=l.useState(!0);l.useEffect(()=>{const r=!Object.values(p).every(u=>u===!1);C(r||m.length<1)},[p,m]);const S=r=>{h([...m,r])},F=r=>{const u=[...m];u.splice(r,1),h(u)},P=()=>{const r={negozio:a.negozio,...s,reparti:m};n(ee(a==null?void 0:a.id,r))};return o(k,{children:[e(f,{mb:3,children:e(y,{variant:"h3",children:"Aggiungi Chiusura Fiscale"})}),e(f,{mb:3,children:e(A,{children:o(f,{p:2,children:[e(g,{label:"Data",name:"data",value:s.data,error:p.data,fullWidth:!0,required:!0,onChange:b,margin:"normal",type:"date"}),e(g,{label:"Totale",name:"totale",value:s.totale,error:p.totale,fullWidth:!0,required:!0,onChange:b,margin:"normal",type:"number"}),e(g,{label:"Num. D.F.",name:"numeroDocFisc",value:s.numeroDocFisc,error:p.numeroDocFisc,fullWidth:!0,required:!0,onChange:b,margin:"normal",type:"number"})]})})}),e(f,{children:e(A,{children:o(f,{p:2,children:[o(q,{container:!0,direction:"row",justifyContent:"space-around",alignItems:"center",children:[e(q,{item:!0,xs:6,children:e(y,{variant:"h6",gutterBottom:!0,children:"Reparti"})}),e(q,{item:!0,xs:6,children:e(f,{sx:{textAlign:"right"},children:e(B,{onClick:()=>t(!0),children:"aggiungi"})})})]}),e(f,{mt:2,children:H.isEmpty(m)?e(J,{severity:"error",children:"Devi aggiungere almeno un reparto!"}):o(Q,{children:[e(Y,{children:o(E,{children:[e(c,{children:"Aliquota"}),e(c,{children:"Totale"}),e(c,{children:"Annulli"}),e(c,{children:"Resi"}),e(c,{sx:{width:50},align:"center",children:e(T,{})})]})}),e(X,{children:m.map((r,u)=>o(E,{children:[o(c,{children:[r.aliquota," %"]}),o(c,{children:[r.totale," €"]}),o(c,{children:[r.totaleAnnulli," €"]}),o(c,{children:[r.totaleResi," €"]}),e(c,{align:"center",children:e(K,{color:"error",onClick:()=>F(u),children:e(T,{})})})]},u))})]})})]})})}),e(Z,{open:d,handleClose:t,handleSubmit:S}),e(V,{handleClick:P,disabled:v})]})},Be=()=>{const a=x(),{id:n}=z(),{dettagli:d,getting:t,getError:s}=I(i=>i.chiusureFiscali);return l.useEffect(()=>{n&&a(O(n))},[n]),t?e(L,{}):s?e(G,{message:s}):e(te,{dettagli:d})};export{Be as default};
